{"version":3,"sources":["types.ts","resources/weather.csv","util.ts","stores/DefaultWorldModel.ts","stores/common.ts","analysis/analysisConstants.ts","orbitController.tsx","resources/daysky.jpg","resources/nightsky.jpg","resources/desert.jpg","resources/desert-night.jpg","resources/grassland.jpg","resources/grassland-night.jpg","views/sky.tsx","views/axes.tsx","assets/compass.obj","fonts/helvetiker_regular.typeface.fnt","views/compass.tsx","views/foundation.tsx","views/sensor.tsx","views/cuboid.tsx","elementsRenderer.tsx","views/ground.tsx","assets/menu.svg","analysis/sunTools.ts","views/heliodon.tsx","assets/aladdin-logo.png","assets/ifi-logo.png","components/symbols.tsx","mainMenu.tsx","components/maps.tsx","components/spinner.tsx","panels/groundPanel.tsx","panels/heliodonPanel.tsx","constants.ts","helpers.ts","acceptCookie.tsx","views/groundImage.tsx","contextMenu.tsx","components/barGraph.tsx","components/lineGraph.tsx","panels/weatherPanel.tsx","panels/yearlyLightSensorPanel.tsx","panels/dailyLightSensorPanel.tsx","analysis/simulation.tsx","mainToolBar.tsx","team.tsx","about.tsx","app.tsx","reportWebVitals.ts","index.tsx"],"names":["GraphDataType","Theme","ObjectType","Util","Vector3","x","Math","abs","ZERO_TOLERANCE","PI","to","from","y","z","v","degrees","radians","sphereCoords","a","cos","sin","set","lng1","lat1","lng2","lat2","toRadians","acos","date","dayOfYear","Date","start","getFullYear","diff","getTime","floor","extend","TextSprite","OrbitControls","DefaultWorldModel","name","cameraPosition","panCenter","ground","this","albedo","thermalDiffusivity","snowReflectionFactors","Array","fill","elements","e1","type","Foundation","cx","cy","lx","ly","height","id","e2","Cuboid","e3","Sensor","cz","normal","showLabel","light","heatFlux","push","enableMapSet","AirMass","useStore","create","devtools","persist","get","api","immerSet","fn","produce","defaultWorldModel","defaultElements","getElements","world","showGroundPanel","showHeliodonPanel","showWeatherPanel","showDailyLightSensorPanel","showYearlyLightSensorPanel","autoRotate","grid","axes","groundImage","groundColor","theme","heliodon","address","latitude","longitude","mapZoom","mapType","mapTilt","mapWeatherStations","toString","weatherData","timesPerHour","yearlyLightSensorData","setYearlyLightSensorData","data","state","dailyLightSensorData","setDailyLightSensorData","enableOrbitController","clickObjectType","getSelectedElement","e","selected","getElementById","selectNone","updateElementById","newProps","entries","i","setElementPosition","loadWeatherData","Papa","parse","weather","download","complete","results","row","isArray","length","lows","highs","sun","parseFloat","trim","wm","city","country","elevation","lowestTemperatures","highestTemperatures","sunshineHours","getWeather","location","getClosestCity","lat","lng","distance","min","Number","MAX_VALUE","wd","hasOwnProperty","getDistance","OrbitController","enabled","orbitControlsRef","setCommonStore","useThree","camera","domElement","gl","controls","useRef","useEffect","c","current","target","addEventListener","onInteractionEnd","update","removeEventListener","w","position","useFrame","ref","args","enableRotate","enablePan","enableZoom","enableDamping","maxAzimuthAngle","Infinity","minAzimuthAngle","maxPolarAngle","HALF_PI","minPolarAngle","Sky","night","props","meshRef","texture","useMemo","loader","TextureLoader","load","DesertNightSkyImage","DesertDaySkyImage","GrasslandNightSkyImage","GrasslandDaySkyImage","DefaultNightSkyImage","DefaultDaySkyImage","clickSky","intersections","object","scale","onContextMenu","onClick","map","side","BackSide","opacity","color","Axes","lineWidth","endPoint","Line","points","Compass","model","useLoader","OBJLoader","compassObj","font","FontLoader","helvetikerFont","mesh","textGeometryParams","size","textMaterial","MeshBasicMaterial","compassMaterial","unproject","rotation","Euler","material","lineColor","useState","hovered","setHovered","baseRef","resizeHandleLLRef","resizeHandleULRef","resizeHandleLRRef","resizeHandleURRef","moveHandleLowerRef","moveHandleUpperRef","moveHandleLeftRef","moveHandleRightRef","handleSize","offset","positionLL","positionUL","positionLR","positionUR","selectMe","castShadow","receiveShadow","onPointerOver","onPointerOut","onPointerDown","onPointerUp","onPointerMove","attach","text","fontSize","fontFace","textHeight","handleRef","element","lit","resizeHandleLLTopRef","resizeHandleULTopRef","resizeHandleLRTopRef","resizeHandleURTopRef","resizeHandleLLBotRef","resizeHandleULBotRef","resizeHandleLRBotRef","resizeHandleURBotRef","positionLLTop","positionULTop","positionLRTop","positionURTop","positionLLBot","positionULBot","positionLRBot","positionURBot","moveHandleLowerFaceRef","moveHandleUpperFaceRef","moveHandleLeftFaceRef","moveHandleRightFaceRef","moveHandleTopFaceRef","positionLowerFace","positionUpperFace","positionLeftFace","positionRightFace","positionTopFace","ElementsRenderer","filter","Ground","grabbedElement","setGrabbedElement","planeRef","ray","Raycaster","mouse","Vector2","clientX","window","innerWidth","clientY","innerHeight","setFromCamera","intersects","intersectObjects","p","point","ASHRAE_C","_defs","_path","_path2","_path3","_path4","_path5","_path6","TILT_ANGLE","computeDeclinationAngle","days","TWO_PI","computeHourAngle","getHours","getMinutes","getSunDirection","computeSunLocation","normalize","radius","hourAngle","declinationAngle","cosDec","sinDec","cosLat","sinLat","cosHou","sinHou","altitudeAngle","asin","xAzm","yAzm","azimuthAngle","atan2","coords","sphericalToCartesianZ","calculatePeakRadiation","sunDirection","altitude","airMassType","b","getExtraterrestrialRadiation","pow","zenithAngle","NONE","KASTEN_YOUNG","angleTo","UNIT_VECTOR_POS_Z","r","sqrt","computeAirMass","calculateDiffuseAndReflectedRadiation","month","peakRadiation","result","dot","viewFactorWithSky","viewFactorWithGround","isZero","Heliodon","basePoints","tickPoints","step","counter","angle","theta","width","basePositions","Float32Array","baseNormals","baseColors","j","sunPathPoints","h","getSunPathPointsByDate","d","pointArraySunPaths","dMin","delta","arr","sunPosition","sunbeltGeometry","declinationStep","hourStep","geometry","BufferGeometry","verticesCount","vertices","indices","h2","d2","v1","v2","v3","v4","setFromPoints","setIndex","BufferAttribute","Uint16Array","attachObject","count","array","itemSize","DoubleSide","vertexColors","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","index","Color","transparent","clippingPlanes","Plane","UNIT_VECTOR_POS_Y","SphereGeometry","_extends","Object","assign","arguments","source","key","prototype","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgMenu","_ref","svgRef","title","titleId","t","className","viewBox","xmlns","xmlnsXlink","Direction","ForwardRef","SubMenu","Menu","StyledMenuSVG","styled","MenuSVG","MainMenu","collectDailyLightSensorData","collectYearlyLightSensorData","openAboutUs","menu","Item","checked","onChange","overlay","trigger","containerStyle","border","Maps","setLatitude","setLongitude","setZoom","setTilt","setType","zoom","tilt","setMap","bounds","cities","updateFlag","setUpdateFlag","onLoad","useCallback","onUnmount","latLng","mapContainerStyle","mapTypeId","center","onBoundsChanged","getBounds","pos","google","maps","LatLng","contains","loadCities","onCenterChanged","getCenter","onZoomChanged","getZoom","onTiltChanged","getTilt","onMapTypeIdChanged","typeId","getMapTypeId","icon","path","SymbolPath","CIRCLE","strokeColor","strokeWeight","memo","Spin","libraries","Container","div","ColumnWrapper","Header","GroundPanel","setGrid","setGroundImage","setGroundColor","changeLatitude","changeLongitude","changeMapZoom","changeMapTilt","changeMapType","searchBox","curPosition","setCurPosition","useJsApiLoader","googleMapsApiKey","process","isLoaded","loadError","handle","axis","onDrag","ui","onStart","onStop","style","cursor","direction","padding","align","on","onChangeComplete","colorResult","hex","s","onPlacesChanged","places","getPlaces","formatted_address","placeholder","boxSizing","borderRadius","boxShadow","outline","textOverflow","toFixed","HeliodonPanel","animateSun","setHeliodon","setSunAnimation","changeDate","changeTime","requestRef","previousFrameTime","requestAnimationFrame","animate","cancelAnimationFrame","currentFrameTime","now","day","getDate","setHours","setDate","value","moment","toDate","format","marks","0","90","max","tooltipVisible","defaultValue","PRESET_COLORS","MONTHS","visitIFI","open","AcceptCookie","buttonText","cookieName","background","textAlign","zIndex","buttonStyle","expires","GroundImage","useTexture","StyledMenu","radioStyle","display","paddingLeft","lineHeight","ContextMenu","selectedElement","margin","Group","Default","Desert","Grassland","BarGraph","dataSource","labelX","labelY","unitX","unitY","yMin","yMax","fractionDigits","referenceX","dataSetCount","setDataSetCount","horizontalGridLines","verticalGridLines","legendDataKey","setLegendDataKey","len","getBars","bars","MonthlyTemperatures","SunshineHours","HourlyTemperatures","DaylightData","ClearnessData","DailyRadiationSensorData","YearlyRadiationSensorData","Bar","dataKey","isAnimationActive","userSelect","top","left","ResponsiveContainer","BarChart","onMouseDown","right","bottom","Tooltip","formatter","CartesianGrid","vertical","horizontal","stroke","ReferenceLine","strokeWidth","XAxis","Label","YAxis","domain","dx","Legend","iconType","verticalAlign","onMouseLeave","o","onMouseEnter","SYMBOLS","CircleSymbol","numberOfSymbols","interval","round","SquareSymbol","TriangleSymbol","pointsString","UP","LEFT","RIGHT","DiamondSymbol","StarSymbol","HexagonSymbol","createSymbol","DOWN","LineGraph","curveType","symbolCount","lineCount","setLineCount","symbolSize","getLines","defaultSymbol","lines","symbol","LineChart","WeatherPanel","graphs","rest","responsiveHeight","getData","forEach","g","Month","Low","High","Sunshine","yNames","yUnits","daysIntoYear","YearlyLightSensorPanel","sensorData","Daylight","Clearness","DailyLightSensorPanel","Simulation","dailyLightSensorDataFlag","yearlyLightSensorDataFlag","scene","collectAllDailyLightSensorData","collectAllYearlyLightSensorData","inShadow","time","modelToView","content","children","components","objects","Map","datum","k","sensor","year","getMonth","cur","SPHERE_MODEL","daylight","clearness","resultArr","Radiation","midMonth","total","hour","MainToolBar","orbitControls","paddingRight","reset","Team","linePos","top110","top250","marginTop","rel","href","marginRight","About","App","setHourAngle","setDeclinationAngle","sunlightDirection","setSunlightDirection","setAnimateSun","setCity","setDailyLightSensorDataFlag","setYearlyLightSensorDataFlag","aboutUs","setAboutUs","applyEuler","nowString","sunAboveHorizon","console","log","backgroundColor","paddingTop","alt","src","aladdinLogo","ifiLogo","setFullYear","setMonth","shadows","fov","fallback","intensity","shadow-mapSize-height","shadow-mapSize-width","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document"],"mappings":"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","file":"static/js/main.c9367c5a.chunk.js","sourcesContent":["/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {extend, Object3DNode} from \"@react-three/fiber\";\r\nimport TextSprite from \"three-spritetext\";\r\nimport {OrbitControls} from \"three/examples/jsm/controls/OrbitControls\";\r\n\r\n// Extend makes these JSX elements (with the first character lower-cased)\r\nextend({TextSprite});\r\nextend({OrbitControls});\r\n\r\ndeclare global {\r\n    namespace JSX {\r\n        interface IntrinsicElements {\r\n            'textSprite': Object3DNode<TextSprite, typeof TextSprite>;\r\n            'orbitControls': Object3DNode<OrbitControls, typeof OrbitControls>;\r\n        }\r\n    }\r\n}\r\n\r\nexport interface DatumEntry {\r\n    [key: string]: number | undefined | string;\r\n}\r\n\r\nexport enum GraphDataType {\r\n    HourlyTemperatures = 0,\r\n    MonthlyTemperatures = 1,\r\n    SunshineHours = 2,\r\n    DaylightData = 3,\r\n    ClearnessData = 4,\r\n    YearlyRadiationSensorData = 5,\r\n    DailyRadiationSensorData = 6,\r\n}\r\n\r\nexport enum Theme {\r\n    Default = 'Default',\r\n    Desert = 'Desert',\r\n    Grassland = 'Grassland',\r\n}\r\n\r\nexport enum ObjectType {\r\n    Sky = 'Sky',\r\n    Ground = 'Ground',\r\n    Foundation = 'Foundation',\r\n    Sensor = 'Sensor',\r\n    Cuboid = 'Cuboid',\r\n}\r\n","export default __webpack_public_path__ + \"static/media/weather.55ddf5ca.csv\";","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {Vector3} from \"three\";\r\n\r\nexport class Util {\r\n\r\n    static get UNIT_VECTOR_POS_X() {\r\n        return new Vector3(1, 0, 0);\r\n    }\r\n\r\n    static get UNIT_VECTOR_NEG_X() {\r\n        return new Vector3(-1, 0, 0);\r\n    }\r\n\r\n    static get UNIT_VECTOR_POS_Y() {\r\n        return new Vector3(0, 1, 0);\r\n    }\r\n\r\n    static get UNIT_VECTOR_NEG_Y() {\r\n        return new Vector3(0, -1, 0);\r\n    }\r\n\r\n    static get UNIT_VECTOR_POS_Z() {\r\n        return new Vector3(0, 0, 1);\r\n    }\r\n\r\n    static get UNIT_VECTOR_NEG_Z() {\r\n        return new Vector3(0, 0, -1);\r\n    }\r\n\r\n    static isZero(x: number) {\r\n        return Math.abs(x) < Util.ZERO_TOLERANCE;\r\n    }\r\n\r\n    static get ZERO_TOLERANCE() {\r\n        return 0.0001;\r\n    }\r\n\r\n    static get HALF_PI() {\r\n        return Math.PI / 2;\r\n    }\r\n\r\n    static get TWO_PI() {\r\n        return Math.PI * 2;\r\n    }\r\n\r\n    static copyVector(to: Vector3, from: Vector3) {\r\n        to.x = from.x;\r\n        to.y = from.y;\r\n        to.z = from.z;\r\n    }\r\n\r\n    static setVector(v: Vector3, x: number, y: number, z: number) {\r\n        v.x = x;\r\n        v.y = y;\r\n        v.z = z;\r\n    }\r\n\r\n    // convert the coordinates from the model system to the view system\r\n    static modelToView(v: Vector3) {\r\n        return new Vector3(v.x, v.z, -v.y);\r\n    }\r\n\r\n    // convert the coordinates from the view system to the model system\r\n    static viewToModel(v: Vector3) {\r\n        return new Vector3(v.x, -v.z, v.y);\r\n    }\r\n\r\n    static toRadians(degrees: number) {\r\n        return degrees * (Math.PI / 180);\r\n    }\r\n\r\n    static toDegrees(radians: number) {\r\n        return radians * (180 / Math.PI);\r\n    }\r\n\r\n    static sphericalToCartesianZ(sphereCoords: Vector3) {\r\n        let a = sphereCoords.x * Math.cos(sphereCoords.z);\r\n        let x = a * Math.cos(sphereCoords.y);\r\n        let y = a * Math.sin(sphereCoords.y);\r\n        let z = sphereCoords.x * Math.sin(sphereCoords.z);\r\n        sphereCoords.set(x, y, z);\r\n        return sphereCoords;\r\n    }\r\n\r\n    // the spherical law of cosines: https://en.wikipedia.org/wiki/Spherical_law_of_cosines\r\n    static getDistance(lng1: number, lat1: number, lng2: number, lat2: number) {\r\n        lng1 = Util.toRadians(lng1);\r\n        lat1 = Util.toRadians(lat1);\r\n        lng2 = Util.toRadians(lng2);\r\n        lat2 = Util.toRadians(lat2);\r\n        return Math.acos(Math.sin(lat1) * Math.sin(lat2) + Math.cos(lat1) * Math.cos(lat2) * Math.cos(Math.abs(lng1 - lng2)));\r\n    }\r\n\r\n    static daysIntoYear(date: string) {\r\n        return Util.dayOfYear(new Date(date));\r\n    }\r\n\r\n    static dayOfYear(date: Date) {\r\n        const start = new Date(date.getFullYear(), 0, 0);\r\n        const diff = date.getTime() - start.getTime();\r\n        const oneDay = 1000 * 60 * 60 * 24;\r\n        return Math.floor(diff / oneDay);\r\n    }\r\n\r\n}\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {ElementModel} from \"../models/elementModel\";\r\nimport {ObjectType} from \"../types\";\r\nimport {FoundationModel} from \"../models/foundationModel\";\r\nimport {CuboidModel} from \"../models/cuboidModel\";\r\nimport {SensorModel} from \"../models/sensorModel\";\r\nimport {Vector3} from \"three\";\r\nimport {WorldModel} from \"../models/worldModel\";\r\nimport {GroundModel} from \"../models/groundModel\";\r\n\r\nexport class DefaultWorldModel implements WorldModel {\r\n\r\n    name: string;\r\n    cameraPosition: Vector3;\r\n    panCenter: Vector3;\r\n    ground: GroundModel;\r\n\r\n    constructor() {\r\n\r\n        this.name = 'default';\r\n        this.ground = {\r\n            albedo: 0.3,\r\n            thermalDiffusivity: 0.05,\r\n            snowReflectionFactors: new Array(12).fill(0)\r\n        };\r\n        this.panCenter = new Vector3(0, 0, 0);\r\n        this.cameraPosition = new Vector3(0, 0, 5);\r\n\r\n    }\r\n\r\n    getElements() {\r\n        const elements: ElementModel[] = [];\r\n        const e1 = {\r\n            type: ObjectType.Foundation,\r\n            cx: 0,\r\n            cy: 0,\r\n            lx: 2,\r\n            ly: 2,\r\n            height: 0.1,\r\n            id: 'f1'\r\n        } as FoundationModel;\r\n        const e2 = {\r\n            type: ObjectType.Cuboid,\r\n            cx: 0,\r\n            cy: 3,\r\n            lx: 2,\r\n            ly: 2,\r\n            height: 4,\r\n            id: 'c1'\r\n        } as CuboidModel;\r\n        const e3 = {\r\n            type: ObjectType.Sensor,\r\n            cx: 2,\r\n            cy: 5,\r\n            cz: 0,\r\n            lx: 0.05,\r\n            ly: 0.05,\r\n            normal: [0, 0, 1],\r\n            height: 0.01,\r\n            id: 's1',\r\n            showLabel: false,\r\n            light: true,\r\n            heatFlux: false\r\n        } as SensorModel;\r\n        const e4 = {\r\n            type: ObjectType.Sensor,\r\n            cx: 0,\r\n            cy: 5,\r\n            cz: 0,\r\n            lx: 0.05,\r\n            ly: 0.05,\r\n            normal: [0, 0, 1],\r\n            height: 0.01,\r\n            id: 's2',\r\n            showLabel: false,\r\n            light: true,\r\n            heatFlux: false\r\n        } as SensorModel;\r\n        const e5 = {\r\n            type: ObjectType.Sensor,\r\n            cx: 0,\r\n            cy: 6,\r\n            cz: 0,\r\n            lx: 0.05,\r\n            ly: 0.05,\r\n            normal: [0, 0, 1],\r\n            height: 0.01,\r\n            id: 's3',\r\n            showLabel: false,\r\n            light: true,\r\n            heatFlux: false\r\n        } as SensorModel;\r\n        elements.push(e1);\r\n        elements.push(e2);\r\n        elements.push(e3);\r\n        // elements.push(e4);\r\n        // elements.push(e5);\r\n        return elements;\r\n    }\r\n\r\n}\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport create from 'zustand';\r\nimport {devtools, persist} from 'zustand/middleware';\r\nimport produce, {enableMapSet} from 'immer';\r\nimport {WorldModel} from \"../models/worldModel\";\r\nimport {ElementModel} from \"../models/elementModel\";\r\nimport {WeatherModel} from \"../models/weatherModel\";\r\nimport weather from '../resources/weather.csv';\r\nimport Papa from \"papaparse\";\r\nimport {Util} from \"../util\";\r\nimport {DatumEntry} from \"../types\";\r\nimport {DefaultWorldModel} from \"./DefaultWorldModel\";\r\n\r\nenableMapSet();\r\n\r\nexport interface CommonStoreState {\r\n    set: (fn: (state: CommonStoreState) => void) => void;\r\n    world: WorldModel;\r\n    elements: ElementModel[];\r\n\r\n    showGroundPanel: boolean;\r\n    showHeliodonPanel: boolean;\r\n    showWeatherPanel: boolean;\r\n    showDailyLightSensorPanel: boolean;\r\n    showYearlyLightSensorPanel: boolean;\r\n    autoRotate: boolean;\r\n\r\n    grid: boolean;\r\n    axes: boolean;\r\n    groundImage: boolean;\r\n    groundColor: string;\r\n    theme: string;\r\n    heliodon: boolean;\r\n    address: string;\r\n    latitude: number;\r\n    longitude: number;\r\n    mapZoom: number;\r\n    mapType: string;\r\n    mapTilt: number;\r\n    mapWeatherStations: boolean;\r\n    date: string;\r\n\r\n    weatherData: { [key: string]: WeatherModel };\r\n    getWeather: (location: string) => WeatherModel;\r\n    loadWeatherData: () => void;\r\n    getClosestCity: (lat: number, lng: number) => string | null;\r\n\r\n    enableOrbitController: boolean;\r\n    clickObjectType: string | null;\r\n    getSelectedElement: () => ElementModel | null;\r\n    getElementById: (id: string) => ElementModel | null;\r\n    selectNone: () => void;\r\n    updateElementById: (id: string, element: Partial<ElementModel>) => void;\r\n    setElementPosition: (id: string, x: number, y: number, z: number) => void;\r\n\r\n    timesPerHour: number;\r\n    dailyLightSensorData: DatumEntry[];\r\n    setDailyLightSensorData: (data: DatumEntry[]) => void;\r\n    yearlyLightSensorData: DatumEntry[];\r\n    setYearlyLightSensorData: (data: DatumEntry[]) => void;\r\n\r\n}\r\n\r\nexport const useStore = create<CommonStoreState>(devtools(persist((\r\n    set,\r\n    get,\r\n    api,\r\n) => {\r\n\r\n    const immerSet: CommonStoreState['set'] = fn => set(produce(fn));\r\n    const defaultWorldModel = new DefaultWorldModel();\r\n    const defaultElements = defaultWorldModel.getElements();\r\n\r\n    return {\r\n\r\n        set: immerSet,\r\n        world: defaultWorldModel,\r\n        elements: defaultElements,\r\n\r\n        showGroundPanel: false,\r\n        showHeliodonPanel: false,\r\n        showWeatherPanel: false,\r\n        showDailyLightSensorPanel: false,\r\n        showYearlyLightSensorPanel: false,\r\n        autoRotate: false,\r\n\r\n        grid: false,\r\n        axes: true,\r\n        groundImage: false,\r\n        groundColor: 'forestgreen',\r\n        theme: 'Default',\r\n        heliodon: false,\r\n\r\n        address: 'Natick, MA',\r\n        latitude: 42.2844063,\r\n        longitude: -71.3488548,\r\n        mapZoom: 16,\r\n        mapType: 'roadmap',\r\n        mapTilt: 0,\r\n        mapWeatherStations: false,\r\n        date: new Date(2021, 5, 22, 12).toString(),\r\n        weatherData: {},\r\n\r\n        timesPerHour: 20, // how many times per hour to collect data\r\n\r\n        yearlyLightSensorData: [],\r\n        setYearlyLightSensorData(data) {\r\n            immerSet((state: CommonStoreState) => {\r\n                state.yearlyLightSensorData = [...data];\r\n            });\r\n        },\r\n        dailyLightSensorData: [],\r\n        setDailyLightSensorData(data) {\r\n            immerSet((state: CommonStoreState) => {\r\n                state.dailyLightSensorData = [...data];\r\n            });\r\n        },\r\n\r\n        enableOrbitController: true,\r\n        clickObjectType: null,\r\n        getSelectedElement() {\r\n            const elements = get().elements;\r\n            for (const e of elements) {\r\n                if (e.selected) {\r\n                    return e;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        getElementById(id: string) {\r\n            const elements = get().elements;\r\n            for (const e of elements) {\r\n                if (e.id === id) {\r\n                    return e;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        selectNone() {\r\n            immerSet((state: CommonStoreState) => {\r\n                for (const e of state.elements) {\r\n                    e.selected = false;\r\n                }\r\n            });\r\n        },\r\n        updateElementById(id, newProps) {\r\n            immerSet((state: CommonStoreState) => {\r\n                for (let [i, e] of state.elements.entries()) {\r\n                    if (e.id === id) {\r\n                        state.elements[i] = {...e, ...newProps};\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        setElementPosition(id, x, y, z) {\r\n            immerSet((state: CommonStoreState) => {\r\n                for (let [i, e] of state.elements.entries()) {\r\n                    if (e.id === id) {\r\n                        state.elements[i].cx = x;\r\n                        state.elements[i].cy = y;\r\n                        state.elements[i].cz = z;\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        },\r\n\r\n        loadWeatherData() {\r\n            const data: WeatherModel[] = [];\r\n            Papa.parse(weather, {\r\n                download: true,\r\n                complete: function (results) {\r\n                    for (const row of results.data) {\r\n                        if (Array.isArray(row) && row.length > 1) {\r\n                            const lows: number[] = [];\r\n                            const highs: number[] = [];\r\n                            const sun: number[] = [];\r\n                            for (let i = 5; i < 29; i++) {\r\n                                if ((i - 5) % 2 === 0) {\r\n                                    lows.push(parseFloat(row[i].trim()));\r\n                                } else {\r\n                                    highs.push(parseFloat(row[i].trim()));\r\n                                }\r\n                            }\r\n                            for (let i = 29; i < 41; i++) {\r\n                                sun.push(parseFloat(row[i].trim()));\r\n                            }\r\n                            const wm = {\r\n                                city: row[0].trim(),\r\n                                country: row[1].trim(),\r\n                                longitude: parseFloat(row[2].trim()),\r\n                                latitude: parseFloat(row[3].trim()),\r\n                                elevation: parseFloat(row[4].trim()),\r\n                                lowestTemperatures: lows,\r\n                                highestTemperatures: highs,\r\n                                sunshineHours: sun\r\n                            } as WeatherModel;\r\n                            data.push(wm);\r\n                        }\r\n                    }\r\n                    immerSet((state: CommonStoreState) => {\r\n                        for (const row of data) {\r\n                            state.weatherData[row.city + ', ' + row.country] = row;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        getWeather(location: string) {\r\n            return get().weatherData[location];\r\n        },\r\n        getClosestCity(lat: number, lng: number) {\r\n            let min: number = Number.MAX_VALUE;\r\n            let city = null;\r\n            let distance: number;\r\n            const wd = get().weatherData;\r\n            for (const name in wd) {\r\n                if (wd.hasOwnProperty(name)) {\r\n                    distance = Util.getDistance(lng, lat, wd[name].longitude, wd[name].latitude);\r\n                    if (distance < min) {\r\n                        min = distance;\r\n                        city = name;\r\n                    }\r\n                }\r\n            }\r\n            return city;\r\n        }\r\n    };\r\n}, {name: 'aladdin-storage'})));\r\n\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\n// in kW, see http://en.wikipedia.org/wiki/Solar_constant\r\nexport const SOLAR_CONSTANT = 1.361;\r\n\r\n// original ASHRAE_C = [0.058, 0.060, 0.071, 0.097, 0.121, 0.134, 0.136, 0.122, 0.092, 0.073, 0.063, 0.057];\r\n// http://www.physics.arizona.edu/~cronin/Solar/References/Irradiance%20Models%20and%20Data/WOC01.pdf\r\n// revised C coefficients found from Iqbal's book\r\nexport const ASHRAE_C = [0.103, 0.104, 0.109, 0.120, 0.130, 0.137, 0.138, 0.134, 0.121, 0.111, 0.106, 0.103];\r\n\r\nexport enum AirMass {\r\n    NONE = 0,\r\n    KASTEN_YOUNG = 1,\r\n    SPHERE_MODEL = 2\r\n}\r\n\r\nexport const MINUTES_OF_DAY = 1440;\r\n\r\n// the daily cycle is 1440 minutes\r\nexport const OMEGA_DAY = Math.PI / 720;\r\n\r\n// the annual cycle is 365 days\r\nexport const OMEGA_YEAR = Math.PI / 182.5;\r\n\r\nexport const YEARLY_LAG_IN_DAYS = 30;\r\n\r\nexport const DAILY_LAG_IN_MINUTES = 120;\r\n\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useEffect, useRef} from \"react\";\r\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls';\r\nimport {useFrame, useThree} from \"@react-three/fiber\";\r\nimport {useStore} from \"./stores/common\";\r\nimport {Util} from \"./util\";\r\nimport {Vector3} from \"three\";\r\n\r\nexport interface OrbitControllerProps {\r\n    enabled?: boolean;\r\n    autoRotate?: boolean;\r\n    panCenter?: Vector3;\r\n    orbitControlsRef?: React.MutableRefObject<OrbitControls | undefined>;\r\n\r\n    [key: string]: any;\r\n}\r\n\r\n// Get a reference to the Three.js Camera, and the canvas html element.\r\n// We need these to setup the OrbitControls class.\r\n// https://threejs.org/docs/#examples/en/controls/OrbitControls\r\nconst OrbitController = ({\r\n                             enabled = true,\r\n                             autoRotate = false,\r\n                             panCenter = new Vector3(),\r\n                             orbitControlsRef,\r\n                         }: OrbitControllerProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const {camera, gl: {domElement}} = useThree();\r\n    // Ref to the controls, so that we can update them on every frame using useFrame\r\n    const controls = useRef<OrbitControls>(null);\r\n\r\n    useEffect(() => {\r\n        const c = controls.current;\r\n        if (c) {\r\n            if (panCenter) {\r\n                c.target.set(panCenter.x, panCenter.y, panCenter.z);\r\n            }\r\n            c.addEventListener('end', onInteractionEnd);\r\n            c.update();\r\n            if (orbitControlsRef) {\r\n                orbitControlsRef.current = c;\r\n            }\r\n        }\r\n        return () => {\r\n            if (c) {\r\n                c.removeEventListener('end', onInteractionEnd);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    const onInteractionEnd = () => {\r\n        setCommonStore((state) => {\r\n            const w = state.world;\r\n            // FIXME: why can't set function be used?\r\n            w.cameraPosition.x = camera.position.x;\r\n            w.cameraPosition.y = camera.position.y;\r\n            w.cameraPosition.z = camera.position.z;\r\n            if (controls.current) {\r\n                w.panCenter.x = controls.current.target.x;\r\n                w.panCenter.y = controls.current.target.y;\r\n                w.panCenter.z = controls.current.target.z;\r\n            }\r\n        });\r\n    };\r\n\r\n    // animation\r\n    useFrame((state) => {\r\n        if (autoRotate) {\r\n            if (controls.current) {\r\n                controls.current.update();\r\n            }\r\n        }\r\n    });\r\n\r\n    return (\r\n        <orbitControls\r\n            ref={controls}\r\n            args={[camera, domElement]}\r\n            autoRotate={autoRotate}\r\n            enabled={enabled}\r\n            enableRotate={true}\r\n            enablePan={true}\r\n            enableZoom={true}\r\n            enableDamping={true}\r\n            target={panCenter}\r\n            maxAzimuthAngle={Infinity}\r\n            minAzimuthAngle={-Infinity}\r\n            maxPolarAngle={Util.HALF_PI}\r\n            minPolarAngle={0}\r\n        />\r\n    );\r\n\r\n};\r\n\r\nexport default OrbitController;\r\n","export default __webpack_public_path__ + \"static/media/daysky.66925efd.jpg\";","export default __webpack_public_path__ + \"static/media/nightsky.2ee37da6.jpg\";","export default __webpack_public_path__ + \"static/media/desert.e1e10657.jpg\";","export default __webpack_public_path__ + \"static/media/desert-night.6f0f274c.jpg\";","export default __webpack_public_path__ + \"static/media/grassland.d74bba81.jpg\";","export default __webpack_public_path__ + \"static/media/grassland-night.fa2ff11e.jpg\";","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useMemo, useRef} from \"react\";\r\nimport DefaultDaySkyImage from \"../resources/daysky.jpg\";\r\nimport DefaultNightSkyImage from \"../resources/nightsky.jpg\";\r\nimport DesertDaySkyImage from \"../resources/desert.jpg\";\r\nimport DesertNightSkyImage from \"../resources/desert-night.jpg\";\r\nimport GrasslandDaySkyImage from \"../resources/grassland.jpg\";\r\nimport GrasslandNightSkyImage from \"../resources/grassland-night.jpg\";\r\nimport {BackSide, Mesh, TextureLoader} from \"three\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {ObjectType} from \"../types\";\r\nimport {ThreeEvent} from \"@react-three/fiber\";\r\n\r\nexport interface SkyProps {\r\n    theme?: string,\r\n    night?: boolean,\r\n\r\n    [key: string]: any;\r\n}\r\n\r\nconst Sky = ({\r\n                 theme = 'Default',\r\n                 night = false,\r\n                 ...props\r\n             }: SkyProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const selectNone = useStore(state => state.selectNone);\r\n    const meshRef = useRef<Mesh>(null!);\r\n    const texture = useMemo(() => {\r\n        const loader = new TextureLoader();\r\n        let texture;\r\n        switch (theme) {\r\n            case 'Desert':\r\n                texture = loader.load(night ? DesertNightSkyImage : DesertDaySkyImage);\r\n                break;\r\n            case 'Grassland':\r\n                texture = loader.load(night ? GrasslandNightSkyImage : GrasslandDaySkyImage);\r\n                break;\r\n            default:\r\n                texture = loader.load(night ? DefaultNightSkyImage : DefaultDaySkyImage);\r\n        }\r\n        return texture;\r\n    }, [theme, night]);\r\n\r\n    const clickSky = (e: ThreeEvent<MouseEvent>) => {\r\n        if (e.intersections.length > 0) {\r\n            const skyClicked = e.intersections[0].object === meshRef.current;\r\n            if (skyClicked) {\r\n                selectNone();\r\n                setCommonStore((state) => {\r\n                    state.clickObjectType = ObjectType.Sky;\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <mesh\r\n            {...props}\r\n            ref={meshRef}\r\n            name={'Sky'}\r\n            scale={1}\r\n            onContextMenu={(e) => {\r\n                clickSky(e);\r\n            }}\r\n            onClick={(e) => {\r\n                clickSky(e);\r\n            }}\r\n        >\r\n            <sphereGeometry args={[1000, 16, 16, 0, 2 * Math.PI, 0, Math.PI / 2 + 0.01]}/>\r\n            <meshBasicMaterial map={texture}\r\n                               side={BackSide}\r\n                               opacity={1}\r\n                               color={'skyblue'}/>\r\n        </mesh>\r\n    )\r\n};\r\n\r\nexport default Sky;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from \"react\";\r\nimport {Vector3} from \"three\";\r\nimport {Line} from \"@react-three/drei\";\r\n\r\nexport interface AxesProps {\r\n    lineWidth?: number,\r\n    endPoint?: number,\r\n}\r\n\r\nconst Axes = ({lineWidth = 1, endPoint = 1000}: AxesProps) => {\r\n    return (\r\n        <mesh name={'Axes'}>\r\n            <Line points={[new Vector3(-endPoint, 0, 0), new Vector3(endPoint, 0, 0)]}\r\n                  color={'red'}\r\n                  lineWidth={lineWidth}/>\r\n            <Line points={[new Vector3(0, -endPoint, 0), new Vector3(0, endPoint, 0)]}\r\n                  color={'green'}\r\n                  lineWidth={lineWidth}/>\r\n            <Line points={[new Vector3(0, 0, -endPoint), new Vector3(0, 0, endPoint)]}\r\n                  color={'blue'}\r\n                  lineWidth={lineWidth}/>\r\n        </mesh>\r\n    )\r\n};\r\n\r\nexport default Axes;\r\n","export default __webpack_public_path__ + \"static/media/compass.7ded737e.obj\";","export default __webpack_public_path__ + \"static/media/helvetiker_regular.typeface.9a3651b4.fnt\";","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useRef} from \"react\";\r\nimport {useFrame, useLoader, useThree} from '@react-three/fiber'\r\nimport {OBJLoader} from \"three/examples/jsm/loaders/OBJLoader\";\r\nimport {Euler, FontLoader, Mesh, MeshBasicMaterial, TextGeometryParameters, Vector3} from \"three\";\r\nimport compassObj from '../assets/compass.obj';\r\nimport helvetikerFont from '../fonts/helvetiker_regular.typeface.fnt';\r\n\r\nexport interface CompassProps {\r\n    scale?: number;\r\n\r\n    [key: string]: any;\r\n}\r\n\r\nconst Compass = ({\r\n                     scale = 0.01,\r\n                     ...props\r\n                 }: CompassProps) => {\r\n    const model = useLoader(OBJLoader, compassObj);\r\n    const font = useLoader(FontLoader, helvetikerFont);\r\n    const mesh = useRef<Mesh>(null!);\r\n    const textGeometryParams = {font: font, height: 0.00, size: 0.005} as TextGeometryParameters;\r\n    const textMaterial = new MeshBasicMaterial({color: 'white'});\r\n    const compassMaterial = new MeshBasicMaterial({color: 'red'});\r\n\r\n    // FIXME: This is not the right way to fix the compass\r\n    const {camera} = useThree();\r\n    useFrame((state) => {\r\n        if (mesh.current) {\r\n            const v = new Vector3(0.88, -0.8, 0.1).unproject(camera);\r\n            mesh.current.position.set(v.x, v.y, v.z);\r\n        }\r\n    });\r\n\r\n    return (\r\n        <mesh\r\n            {...props}\r\n            ref={mesh}\r\n            name={'Compass'}\r\n            rotation={new Euler(-Math.PI / 2, 0, 0)}\r\n        >\r\n            <mesh position={[-0.001, 0.02, 0]} material={textMaterial}>\r\n                <textGeometry args={['N', textGeometryParams]}/>\r\n            </mesh>\r\n            <mesh position={[-0.0015, -0.025, 0]} material={textMaterial}>\r\n                <textGeometry args={['S', textGeometryParams]}/>\r\n            </mesh>\r\n            <mesh position={[-0.025, -0.002, 0]} material={textMaterial}>\r\n                <textGeometry args={['W', textGeometryParams]}/>\r\n            </mesh>\r\n            <mesh position={[0.02, -0.002, 0]} material={textMaterial}>\r\n                <textGeometry args={['E', textGeometryParams]}/>\r\n            </mesh>\r\n            <primitive object={model} scale={scale} material={compassMaterial}/>\r\n        </mesh>\r\n    );\r\n};\r\n\r\nexport default Compass;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useRef, useState} from \"react\";\r\nimport {Box, Line, Sphere} from \"@react-three/drei\";\r\nimport {Mesh, Vector3} from \"three\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {FoundationModel} from \"../models/foundationModel\";\r\n\r\nconst Foundation = ({\r\n                        id,\r\n                        cx,\r\n                        cy,\r\n                        lx = 1,\r\n                        ly = 1,\r\n                        height = 0.1,\r\n                        color = 'gray',\r\n                        lineColor = 'black',\r\n                        lineWidth = 0.2,\r\n                        selected = false,\r\n                    }: FoundationModel) => {\r\n\r\n    cy = -cy; // we want positive y to point north\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const [hovered, setHovered] = useState(false);\r\n    const baseRef = useRef<Mesh>();\r\n    const resizeHandleLLRef = useRef<Mesh>();\r\n    const resizeHandleULRef = useRef<Mesh>();\r\n    const resizeHandleLRRef = useRef<Mesh>();\r\n    const resizeHandleURRef = useRef<Mesh>();\r\n    const moveHandleLowerRef = useRef<Mesh>();\r\n    const moveHandleUpperRef = useRef<Mesh>();\r\n    const moveHandleLeftRef = useRef<Mesh>();\r\n    const moveHandleRightRef = useRef<Mesh>();\r\n\r\n    const handleSize = 0.16;\r\n    const offset = 0.2;\r\n    const wireframe = true;\r\n\r\n    const positionLL = new Vector3(cx - lx / 2, height / 2, cy - ly / 2);\r\n    const positionUL = new Vector3(cx - lx / 2, height / 2, cy + ly / 2);\r\n    const positionLR = new Vector3(cx + lx / 2, height / 2, cy - ly / 2);\r\n    const positionUR = new Vector3(cx + lx / 2, height / 2, cy + ly / 2);\r\n\r\n    const selectMe = () => {\r\n        setCommonStore((state) => {\r\n            for (const e of state.elements) {\r\n                e.selected = e.id === id;\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n\r\n        <group name={'Foundation Group'}>\r\n\r\n            {/* draw rectangle */}\r\n            <Box castShadow receiveShadow\r\n                 ref={baseRef}\r\n                 name={'Foundation'}\r\n                 position={[cx, height / 2, cy]}\r\n                 args={[lx, height, ly]}\r\n                 onContextMenu={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOver={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             setHovered(true);\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOut={(e) => {\r\n                     setHovered(false);\r\n                 }}\r\n                 onPointerDown={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerUp={(e) => {\r\n                 }}\r\n                 onPointerMove={(e) => {\r\n                 }}\r\n            >\r\n                <meshStandardMaterial attach=\"material\" color={color}/>\r\n            </Box>\r\n\r\n            {(wireframe && !selected) &&\r\n            <>\r\n                {/* draw wireframe lines upper face */}\r\n                <Line points={[[positionLL.x, height, positionLL.z], [positionLR.x, height, positionLR.z]]}\r\n                      name={'Line LL-LR Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionLR.x, height, positionLR.z], [positionUR.x, height, positionUR.z]]}\r\n                      name={'Line LR-UR Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUR.x, height, positionUR.z], [positionUL.x, height, positionUL.z]]}\r\n                      name={'Line UR-UL Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUL.x, height, positionUL.z], [positionLL.x, height, positionLL.z]]}\r\n                      name={'Line UL-LL Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n\r\n                {/* draw wireframe lines lower face */}\r\n                <Line points={[[positionLL.x, 0, positionLL.z], [positionLR.x, 0, positionLR.z]]}\r\n                      name={'Line LL-LR Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionLR.x, 0, positionLR.z], [positionUR.x, 0, positionUR.z]]}\r\n                      name={'Line LR-UR Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUR.x, 0, positionUR.z], [positionUL.x, 0, positionUL.z]]}\r\n                      name={'Line UR-UL Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUL.x, 0, positionUL.z], [positionLL.x, 0, positionLL.z]]}\r\n                      name={'Line UL-LL Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n\r\n                {/* draw wireframe vertical lines */}\r\n                <Line points={[[positionLL.x, 0, positionLL.z], [positionLL.x, height, positionLL.z]]}\r\n                      name={'Line LL-LL Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionLR.x, 0, positionLR.z], [positionLR.x, height, positionLR.z]]}\r\n                      name={'Line LR-LR Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUL.x, 0, positionUL.z], [positionUL.x, height, positionUL.z]]}\r\n                      name={'Line UL-UL Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUR.x, 0, positionUR.z], [positionUR.x, height, positionUR.z]]}\r\n                      name={'Line UR-UR Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n            </>\r\n            }\r\n\r\n            {/* draw handles */}\r\n            {selected &&\r\n            <>\r\n                {/* resize handles */}\r\n                <Box ref={resizeHandleLLRef}\r\n                     position={positionLL}\r\n                     args={[handleSize, height * 1.2, handleSize]}\r\n                     name={'Resize Handle LL'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleULRef}\r\n                     position={positionUL}\r\n                     args={[handleSize, height * 1.2, handleSize]}\r\n                     name={'Resize Handle UL'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleLRRef}\r\n                     position={positionLR}\r\n                     args={[handleSize, height * 1.2, handleSize]}\r\n                     name={'Resize Handle LR'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleURRef}\r\n                     position={positionUR}\r\n                     args={[handleSize, height * 1.2, handleSize]}\r\n                     name={'Resize Handle UR'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n\r\n                {/* move handles */}\r\n                <Sphere ref={moveHandleLowerRef}\r\n                        args={[0.1, 6, 6]}\r\n                        position={[cx, height / 2, cy - ly / 2 - offset]}\r\n                        name={'Move Handle Lower'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleUpperRef}\r\n                        args={[0.1, 6, 6]}\r\n                        position={[cx, height / 2, cy + ly / 2 + offset]}\r\n                        name={'Move Handle Upper'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleLeftRef}\r\n                        args={[0.1, 6, 6]}\r\n                        position={[cx - lx / 2 - offset, height / 2, cy]}\r\n                        name={'Move Handle Left'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleRightRef}\r\n                        args={[0.1, 6, 6]}\r\n                        position={[cx + lx / 2 + offset, height / 2, cy]}\r\n                        name={'Move Handle Right'}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n            </>\r\n            }\r\n\r\n            {(hovered && !selected) &&\r\n            <textSprite\r\n                name={'Label'}\r\n                text={'Foundation'}\r\n                fontSize={90}\r\n                fontFace={'Times Roman'}\r\n                textHeight={1}\r\n                position={[cx, height + 0.2, cy]}\r\n                scale={[1, 0.2, 0.2]}/>\r\n            }\r\n\r\n        </group>\r\n    )\r\n};\r\n\r\nexport default Foundation;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useRef, useState} from \"react\";\r\nimport {Box, Line, Sphere} from \"@react-three/drei\";\r\nimport {Mesh, Vector3} from \"three\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {SensorModel} from \"../models/sensorModel\";\r\n\r\nconst Sensor = ({\r\n                    id,\r\n                    cx,\r\n                    cy,\r\n                    cz,\r\n                    lx = 1,\r\n                    ly = 1,\r\n                    height = 0.1,\r\n                    color = 'white',\r\n                    lineColor = 'black',\r\n                    lineWidth = 0.1,\r\n                    selected = false,\r\n                    showLabel = false,\r\n                    light = true,\r\n                    heatFlux = false,\r\n                }: SensorModel) => {\r\n\r\n    cy = -cy; // we want positive y to point north\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const getElementById = useStore(state => state.getElementById);\r\n    const [hovered, setHovered] = useState(false);\r\n    const baseRef = useRef<Mesh>();\r\n    const handleRef = useRef<Mesh>();\r\n\r\n    const position = new Vector3(cx, cz, cy);\r\n    const positionLL = new Vector3(cx - lx / 2, 0, cy - ly / 2);\r\n    const positionUL = new Vector3(cx - lx / 2, 0, cy + ly / 2);\r\n    const positionLR = new Vector3(cx + lx / 2, 0, cy - ly / 2);\r\n    const positionUR = new Vector3(cx + lx / 2, 0, cy + ly / 2);\r\n\r\n    const element = getElementById(id);\r\n\r\n    const selectMe = () => {\r\n        setCommonStore((state) => {\r\n            for (const e of state.elements) {\r\n                e.selected = e.id === id;\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n\r\n        <group name={'Sensor Group'}>\r\n\r\n            {/* draw rectangle (too small to cast shadow) */}\r\n            <Box receiveShadow\r\n                 ref={baseRef}\r\n                 args={[lx, height, ly]}\r\n                 position={[cx, height / 2, cy]}\r\n                 name={'Sensor'}\r\n                 onPointerDown={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onContextMenu={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOver={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             setHovered(true);\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOut={(e) => {\r\n                     setHovered(false);\r\n                 }}\r\n            >\r\n                <meshStandardMaterial attach=\"material\" color={element?.lit ? 'red' : color}/>\r\n            </Box>\r\n\r\n            {!selected &&\r\n            <>\r\n                {/* draw wireframe lines upper face */}\r\n                <Line points={[[positionLL.x, height, positionLL.z], [positionLR.x, height, positionLR.z]]}\r\n                      name={'Line LL-LR Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionLR.x, height, positionLR.z], [positionUR.x, height, positionUR.z]]}\r\n                      name={'Line LR-UR Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUR.x, height, positionUR.z], [positionUL.x, height, positionUL.z]]}\r\n                      name={'Line UR-UL Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[[positionUL.x, height, positionUL.z], [positionLL.x, height, positionLL.z]]}\r\n                      name={'Line UL-LL Upper Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n\r\n                {/* draw wireframe lines lower face */}\r\n                <Line points={[positionLL, positionLR]}\r\n                      name={'Line LL-LR Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionLR, positionUR]}\r\n                      name={'Line LR-UR Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionUR, positionUL]}\r\n                      name={'Line UR-UL Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionUL, positionLL]}\r\n                      name={'Line UL-LL Lower Face'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n\r\n                {/* draw wireframe vertical lines */}\r\n                <Line points={[positionLL, [positionLL.x, height, positionLL.z]]}\r\n                      name={'Line LL-LL Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionLR, [positionLR.x, height, positionLR.z]]}\r\n                      name={'Line LR-LR Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionUL, [positionUL.x, height, positionUL.z]]}\r\n                      name={'Line UL-UL Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionUR, [positionUR.x, height, positionUR.z]]}\r\n                      name={'Line UR-UR Vertical'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n            </>\r\n            }\r\n\r\n            {/* draw handle */}\r\n            {selected &&\r\n            <Sphere\r\n                ref={handleRef}\r\n                position={position}\r\n                args={[0.1, 6, 6]}\r\n                name={'Handle'}>\r\n                <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n            </Sphere>\r\n            }\r\n            {(hovered || showLabel) && !selected &&\r\n            <textSprite\r\n                name={'Label'}\r\n                text={'Sensor'}\r\n                fontSize={90}\r\n                fontFace={'Times Roman'}\r\n                textHeight={1}\r\n                scale={[0.5, 0.2, 0.2]}\r\n                position={[cx, height + 0.2, cy]}\r\n            />\r\n            }\r\n        </group>\r\n    )\r\n};\r\n\r\nexport default Sensor;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useRef, useState} from \"react\";\r\nimport {Box, Line, Sphere} from \"@react-three/drei\";\r\nimport {Mesh, Vector3} from \"three\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {CuboidModel} from \"../models/cuboidModel\";\r\n\r\nconst Cuboid = ({\r\n                    id,\r\n                    cx,\r\n                    cy,\r\n                    lx = 1,\r\n                    ly = 1,\r\n                    height = 1,\r\n                    color = 'silver',\r\n                    lineColor = 'black',\r\n                    lineWidth = 0.1,\r\n                    selected = false,\r\n                }: CuboidModel) => {\r\n\r\n    cy = -cy; // we want positive y to point north\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const [hovered, setHovered] = useState(false);\r\n\r\n    const baseRef = useRef<Mesh>();\r\n    const resizeHandleLLTopRef = useRef<Mesh>();\r\n    const resizeHandleULTopRef = useRef<Mesh>();\r\n    const resizeHandleLRTopRef = useRef<Mesh>();\r\n    const resizeHandleURTopRef = useRef<Mesh>();\r\n    const resizeHandleLLBotRef = useRef<Mesh>();\r\n    const resizeHandleULBotRef = useRef<Mesh>();\r\n    const resizeHandleLRBotRef = useRef<Mesh>();\r\n    const resizeHandleURBotRef = useRef<Mesh>();\r\n\r\n    const positionLLTop = new Vector3(cx - lx / 2, height, cy - ly / 2);\r\n    const positionULTop = new Vector3(cx - lx / 2, height, cy + ly / 2);\r\n    const positionLRTop = new Vector3(cx + lx / 2, height, cy - ly / 2);\r\n    const positionURTop = new Vector3(cx + lx / 2, height, cy + ly / 2);\r\n\r\n    const positionLLBot = new Vector3(cx - lx / 2, 0, cy - ly / 2);\r\n    const positionULBot = new Vector3(cx - lx / 2, 0, cy + ly / 2);\r\n    const positionLRBot = new Vector3(cx + lx / 2, 0, cy - ly / 2);\r\n    const positionURBot = new Vector3(cx + lx / 2, 0, cy + ly / 2);\r\n\r\n    const moveHandleLowerFaceRef = useRef<Mesh>();\r\n    const moveHandleUpperFaceRef = useRef<Mesh>();\r\n    const moveHandleLeftFaceRef = useRef<Mesh>();\r\n    const moveHandleRightFaceRef = useRef<Mesh>();\r\n    const moveHandleTopFaceRef = useRef<Mesh>();\r\n\r\n    const offset = 0.1;\r\n    const positionLowerFace = new Vector3(cx, height / 2, cy - ly / 2 - offset);\r\n    const positionUpperFace = new Vector3(cx, height / 2, cy + ly / 2 + offset);\r\n    const positionLeftFace = new Vector3(cx - lx / 2 - offset, height / 2, cy);\r\n    const positionRightFace = new Vector3(cx + lx / 2 + offset, height / 2, cy);\r\n    const positionTopFace = new Vector3(cx, height + offset, cy);\r\n\r\n    const handleSize = 0.16;\r\n\r\n    const selectMe = () => {\r\n        setCommonStore((state) => {\r\n            for (const e of state.elements) {\r\n                e.selected = e.id === id;\r\n            }\r\n        });\r\n    };\r\n\r\n    return (\r\n\r\n        <group name={'Cuboid Group'}>\r\n\r\n            {/* draw rectangular cuboid */}\r\n            <Box castShadow receiveShadow\r\n                 ref={baseRef}\r\n                 args={[lx, height, ly]}\r\n                 position={[cx, height / 2, cy]}\r\n                 name={'Cuboid'}\r\n                 onPointerDown={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onContextMenu={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             selectMe();\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOver={(e) => {\r\n                     if (e.intersections.length > 0) {\r\n                         const intersected = e.intersections[0].object === baseRef.current;\r\n                         if (intersected) {\r\n                             setHovered(true);\r\n                         }\r\n                     }\r\n                 }}\r\n                 onPointerOut={(e) => {\r\n                     setHovered(false);\r\n                 }}\r\n            >\r\n                <meshStandardMaterial attach=\"material\" color={color}/>\r\n            </Box>\r\n\r\n            {!selected &&\r\n            <>\r\n                {/* draw wireframe lines top */}\r\n                <Line points={[positionLLTop, positionLRTop]}\r\n                      name={'Line LL-LR Top'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionLRTop, positionURTop]}\r\n                      name={'Line LR-UR Top'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionURTop, positionULTop]}\r\n                      name={'Line UR-UL Top'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n                <Line points={[positionULTop, positionLLTop]}\r\n                      name={'Line UL-LL Top'}\r\n                      lineWidth={lineWidth}\r\n                      color={lineColor}/>\r\n\r\n                {/* draw wireframe lines lower face */}\r\n                <Line\r\n                    points={[positionLLBot, positionLRBot]}\r\n                    name={'Line LL-LR Bottom'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionLRBot, positionURBot]}\r\n                    name={'Line LR-UR Bottom'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionURBot, positionULBot]}\r\n                    name={'Line UR-UL Bottom'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionULBot, positionLLBot]}\r\n                    name={'Line UL-LL Bottom'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n\r\n                {/* draw wireframe vertical lines */}\r\n                <Line\r\n                    points={[positionLLTop, positionLLBot]}\r\n                    name={'Line LL-LL Vertical'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionLRTop, positionLRBot]}\r\n                    name={'Line LR-LR Vertical'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionULTop, positionULBot]}\r\n                    name={'Line UL-UL Vertical'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n                <Line\r\n                    points={[positionURTop, positionURBot]}\r\n                    name={'Line UR-UR Vertical'}\r\n                    lineWidth={lineWidth}\r\n                    color={lineColor}/>\r\n            </>\r\n            }\r\n\r\n            {/* draw handles */}\r\n            {selected &&\r\n            <>\r\n                {/* resize handles */}\r\n                <Box ref={resizeHandleLLTopRef}\r\n                     name={'Resize Handle LL Top'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionLLTop}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleULTopRef}\r\n                     name={'Resize Handle UL Top'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionULTop}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleLRTopRef}\r\n                     name={'Resize Handle LR Top'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionLRTop}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleURTopRef}\r\n                     name={'Resize Handle UR Top'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionURTop}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleLLBotRef}\r\n                     name={'Resize Handle LL Bottom'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionLLBot}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleULBotRef}\r\n                     name={'Resize Handle UL Bottom'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionULBot}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleLRBotRef}\r\n                     name={'Resize Handle LR Bottom'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionLRBot}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n                <Box ref={resizeHandleURBotRef}\r\n                     name={'Resize Handle UR Bottom'}\r\n                     args={[handleSize, handleSize, handleSize]}\r\n                     position={positionURBot}>\r\n                    <meshStandardMaterial attach=\"material\" color={'white'}/>\r\n                </Box>\r\n\r\n                {/* move handles */}\r\n                <Sphere ref={moveHandleLowerFaceRef}\r\n                        args={[0.1, 6, 6]}\r\n                        name={'Move Handle Lower Face'}\r\n                        position={positionLowerFace}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleUpperFaceRef}\r\n                        args={[0.1, 6, 6]}\r\n                        name={'Move Handle Upper Face'}\r\n                        position={positionUpperFace}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleLeftFaceRef}\r\n                        args={[0.1, 6, 6]}\r\n                        name={'Move Handle Left Face'}\r\n                        position={positionLeftFace}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleRightFaceRef}\r\n                        args={[0.1, 6, 6]}\r\n                        name={'Move Handle Right Face'}\r\n                        position={positionRightFace}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n                <Sphere ref={moveHandleTopFaceRef}\r\n                        args={[0.1, 6, 6]}\r\n                        name={'Move Handle Top Face'}\r\n                        position={positionTopFace}>\r\n                    <meshStandardMaterial attach=\"material\" color={'orange'}/>\r\n                </Sphere>\r\n            </>\r\n            }\r\n\r\n            {hovered && !selected &&\r\n            <textSprite\r\n                name={'Label'}\r\n                text={'Box'}\r\n                fontSize={90}\r\n                fontFace={'Times Roman'}\r\n                textHeight={1}\r\n                scale={[0.4, 0.2, 0.2]}\r\n                position={[cx, height + 0.2, cy]}\r\n            />\r\n            }\r\n\r\n        </group>\r\n    )\r\n};\r\n\r\nexport default Cuboid;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport Foundation from \"./views/foundation\";\r\nimport Sensor from \"./views/sensor\";\r\nimport Cuboid from \"./views/cuboid\";\r\nimport {ObjectType} from \"./types\";\r\nimport {FoundationModel} from \"./models/foundationModel\";\r\nimport {SensorModel} from \"./models/sensorModel\";\r\nimport {CuboidModel} from \"./models/cuboidModel\";\r\nimport {useStore} from \"./stores/common\";\r\n\r\nconst ElementsRenderer: React.FC = () => {\r\n\r\n    const elements = useStore(state => state.elements);\r\n\r\n    return (\r\n        <group name={'Content'}>\r\n            {elements\r\n                .filter(e => e.type === ObjectType.Foundation)\r\n                .map(e => <Foundation key={e.id} {...e as FoundationModel}/>)}\r\n            {elements\r\n                .filter(e => e.type === ObjectType.Sensor)\r\n                .map(e => <Sensor key={e.id} {...e as SensorModel}/>)}\r\n            {elements\r\n                .filter(e => e.type === ObjectType.Cuboid)\r\n                .map(e => <Cuboid key={e.id} {...e as CuboidModel}/>)}\r\n        </group>\r\n    );\r\n};\r\n\r\nexport default ElementsRenderer;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useMemo, useRef, useState} from \"react\";\r\nimport {Plane} from \"@react-three/drei\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {Mesh, Raycaster, Vector2} from \"three\";\r\nimport {ObjectType} from \"../types\";\r\nimport {ElementModel} from \"../models/elementModel\";\r\nimport {useThree} from \"@react-three/fiber\";\r\n\r\nconst Ground = () => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const getSelectedElement = useStore(state => state.getSelectedElement);\r\n    const selectNone = useStore(state => state.selectNone);\r\n    const groundColor = useStore(state => state.groundColor);\r\n    const setElementPosition = useStore(state => state.setElementPosition);\r\n    const [grabbedElement, setGrabbedElement] = useState<ElementModel | null>(null);\r\n    const {camera} = useThree();\r\n    const planeRef = useRef<Mesh>();\r\n    const ray = useMemo(() => new Raycaster(), []);\r\n\r\n    return (\r\n        <Plane receiveShadow\r\n               ref={planeRef}\r\n               name={'Ground'}\r\n               onContextMenu={(e) => {\r\n                   if (e.intersections.length > 0) {\r\n                       const groundClicked = e.intersections[0].object === planeRef.current;\r\n                       if (groundClicked) {\r\n                           selectNone();\r\n                           setCommonStore((state) => {\r\n                               state.clickObjectType = ObjectType.Ground;\r\n                           });\r\n                       }\r\n                   }\r\n               }}\r\n               onPointerDown={(e) => {\r\n                   if (e.intersections.length > 0) {\r\n                       const groundClicked = e.intersections[0].object === planeRef.current;\r\n                       if (groundClicked) {\r\n                           setCommonStore((state) => {\r\n                               state.clickObjectType = ObjectType.Ground;\r\n                           });\r\n                           selectNone();\r\n                       } else {\r\n                           setGrabbedElement(getSelectedElement());\r\n                           setCommonStore((state) => {\r\n                               state.enableOrbitController = false;\r\n                           });\r\n                       }\r\n                   }\r\n               }}\r\n               onPointerUp={(e) => {\r\n                   setGrabbedElement(null);\r\n                   setCommonStore((state) => {\r\n                       state.enableOrbitController = true;\r\n                   });\r\n               }}\r\n               onPointerMove={(e) => {\r\n                   if (grabbedElement && planeRef && planeRef.current) {\r\n                       const mouse = new Vector2();\r\n                       mouse.x = (e.clientX / window.innerWidth) * 2 - 1;\r\n                       mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;\r\n                       ray.setFromCamera(mouse, camera);\r\n                       const intersects = ray.intersectObjects([planeRef.current]);\r\n                       if (intersects.length > 0) {\r\n                           const p = intersects[0].point;\r\n                           setElementPosition(grabbedElement.id, p.x, -p.z, 0);\r\n                       }\r\n                   }\r\n               }}\r\n               rotation={[-Math.PI / 2, 0, 0]}\r\n               position={[0, -0.01, 0]}\r\n               args={[10000, 10000]}\r\n        >\r\n            <meshStandardMaterial attach=\"material\" color={groundColor}/>\r\n        </Plane>\r\n    )\r\n};\r\n\r\nexport default Ground;\r\n","var _defs, _path, _path2, _path3, _path4, _path5, _path6;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgMenu(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    t: 1613755944969,\n    className: \"icon\",\n    viewBox: \"0 0 1024 1024\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    \"p-id\": 5967,\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    width: 200,\n    height: 200,\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", {\n    type: \"text/css\"\n  }))), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M194.187431 235.50871m-69.997795 0a69.997795 69.997795 0 1 0 139.99559 0 69.997795 69.997795 0 1 0-139.99559 0Z\",\n    \"p-id\": 5968\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M347.505182 165.510915h552.305182v139.99559H347.505182z\",\n    \"p-id\": 5969\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M194.187431 512.1129m-69.997795 0a69.997795 69.997795 0 1 0 139.99559 0 69.997795 69.997795 0 1 0-139.99559 0Z\",\n    \"p-id\": 5970\n  })), _path4 || (_path4 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M347.505182 442.115105h552.305182v139.99559H347.505182z\",\n    \"p-id\": 5971\n  })), _path5 || (_path5 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M194.187431 788.49129m-69.997795 0a69.997795 69.997795 0 1 0 139.99559 0 69.997795 69.997795 0 1 0-139.99559 0Z\",\n    \"p-id\": 5972\n  })), _path6 || (_path6 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M347.505182 718.719294h552.305182v139.99559H347.505182z\",\n    \"p-id\": 5973\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMenu);\nexport default __webpack_public_path__ + \"static/media/menu.c2982aed.svg\";\nexport { ForwardRef as ReactComponent };","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {Util} from \"../util\";\r\nimport {Vector3} from \"three\";\r\nimport {AirMass, ASHRAE_C, SOLAR_CONSTANT} from \"./analysisConstants\";\r\nimport {GroundModel} from \"../models/groundModel\";\r\n\r\nexport const TILT_ANGLE = 23.45 / 180.0 * Math.PI;\r\n\r\nexport const computeDeclinationAngle = (date: Date) => {\r\n    const days = Math.floor((date.getTime()\r\n        - new Date(date.getFullYear(), 0, 0).getTime()) / (1000 * 60 * 60 * 24));\r\n    return TILT_ANGLE * Math.sin(Util.TWO_PI * (284 + days) / 365.25);\r\n};\r\n\r\nexport const computeHourAngle = (date: Date) => {\r\n    const minutes = date.getHours() * 60 + date.getMinutes() - 12 * 60;\r\n    return minutes / (12.0 * 60.0) * Math.PI;\r\n}\r\n\r\nexport const getSunDirection = (date: Date, latitude: number) => {\r\n    return computeSunLocation\r\n    (1, computeHourAngle(date), computeDeclinationAngle(date), Util.toRadians(latitude)).normalize();\r\n};\r\n\r\nexport const computeSunLocation = (radius: number,\r\n                                   hourAngle: number,\r\n                                   declinationAngle: number,\r\n                                   latitude: number) => {\r\n    const cosDec = Math.cos(declinationAngle);\r\n    const sinDec = Math.sin(declinationAngle);\r\n    const cosLat = Math.cos(latitude);\r\n    const sinLat = Math.sin(latitude);\r\n    const cosHou = Math.cos(hourAngle);\r\n    const sinHou = Math.sin(hourAngle);\r\n    const altitudeAngle = Math.asin(sinDec * sinLat + cosDec * cosHou * cosLat);\r\n    const xAzm = sinHou * cosDec;\r\n    const yAzm = cosLat * sinDec - cosHou * cosDec * sinLat;\r\n    const azimuthAngle = Math.atan2(yAzm, xAzm);\r\n    const coords = new Vector3(radius, azimuthAngle, altitudeAngle);\r\n    Util.sphericalToCartesianZ(coords);\r\n    // reverse the x so that sun moves from east to west\r\n    coords.x = -coords.x;\r\n    return coords;\r\n};\r\n\r\n// Solar radiation incident outside the earth's atmosphere is called extraterrestrial radiation.\r\n// https://pvpmc.sandia.gov/modeling-steps/1-weather-design-inputs/irradiance-and-insolation-2/extraterrestrial-radiation/\r\nconst getExtraterrestrialRadiation = (dayOfYear: number) => {\r\n    const b = Util.TWO_PI * dayOfYear / 365;\r\n    const er = 1.00011 + 0.034221 * Math.cos(b) + 0.00128 * Math.sin(b) + 0.000719 * Math.cos(2 * b) + 0.000077 * Math.sin(2 * b);\r\n    return SOLAR_CONSTANT * er;\r\n}\r\n\r\n// air mass calculation from http://en.wikipedia.org/wiki/Air_mass_(solar_energy)#At_higher_altitudes\r\nconst computeAirMass = (airMassType: AirMass,\r\n                        sunDirection: Vector3,\r\n                        altitude: number) => {\r\n    let zenithAngle;\r\n    switch (airMassType) {\r\n        case AirMass.NONE:\r\n            return 1;\r\n        case AirMass.KASTEN_YOUNG:\r\n            zenithAngle = sunDirection.angleTo(Util.UNIT_VECTOR_POS_Z);\r\n            return 1 / (Math.cos(zenithAngle) + 0.50572 * Math.pow(96.07995 - zenithAngle / Math.PI * 180, -1.6364));\r\n        default:\r\n            zenithAngle = sunDirection.angleTo(Util.UNIT_VECTOR_POS_Z);\r\n            const cos = Math.cos(zenithAngle);\r\n            const r = 708;\r\n            const c = altitude / 9000;\r\n            return Math.sqrt((r + c) * (r + c) * cos * cos + (2 * r + 1 + c) * (1 - c)) - (r + c) * cos;\r\n    }\r\n};\r\n\r\n// Reused peak solar radiation value. Must be called once and only once before\r\n// calling calculateDirectRadiation and calculateDiffusionAndReflection\r\nexport const calculatePeakRadiation = (sunDirection: Vector3,\r\n                                       dayOfYear: number,\r\n                                       altitude: number,\r\n                                       airMassType: AirMass) => {\r\n    // don't use the 1.1 prefactor as we consider diffuse radiation in the ASHRAE model\r\n    return getExtraterrestrialRadiation(dayOfYear)\r\n        * Math.pow(0.7, Math.pow(computeAirMass(airMassType, sunDirection, altitude), 0.678));\r\n};\r\n\r\n// see: http://www.physics.arizona.edu/~cronin/Solar/References/Irradiance%20Models%20and%20Data/WOC01.pdf\r\nexport const calculateDiffuseAndReflectedRadiation = (ground: GroundModel,\r\n                                                      month: number,\r\n                                                      normal: Vector3,\r\n                                                      peakRadiation: number) => {\r\n    let result = 0;\r\n    const cos = normal.dot(Util.UNIT_VECTOR_POS_Z);\r\n    const viewFactorWithSky = 0.5 * (1 + cos);\r\n    if (viewFactorWithSky > 0) { // diffuse irradiance from the sky\r\n        result += ASHRAE_C[month] * viewFactorWithSky * peakRadiation;\r\n    }\r\n    // if a surface faces down, it should receive ground reflection as well\r\n    const viewFactorWithGround = 0.5 * Math.abs(1 - cos);\r\n    if (!Util.isZero(viewFactorWithGround)) { // short-wave reflection from the ground\r\n        result += ground.albedo * viewFactorWithGround * peakRadiation;\r\n    }\r\n    return result;\r\n}\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {Util} from \"../util\";\r\nimport React, {useEffect, useMemo} from \"react\";\r\nimport {\r\n    BufferAttribute,\r\n    BufferGeometry,\r\n    Color,\r\n    DoubleSide,\r\n    Euler,\r\n    MeshBasicMaterial,\r\n    Plane,\r\n    SphereGeometry,\r\n    Vector3\r\n} from \"three\";\r\nimport {\r\n    computeDeclinationAngle,\r\n    computeSunLocation,\r\n    TILT_ANGLE\r\n} from \"../analysis/sunTools\";\r\nimport {Line} from \"@react-three/drei\";\r\n\r\nexport interface HeliodonProps {\r\n    radius: number;\r\n    hourAngle: number;\r\n    declinationAngle: number;\r\n    date: Date;\r\n    latitude: number; // in radian\r\n\r\n    [key: string]: any;\r\n}\r\n\r\nconst HOUR_DIVISIONS = 96;\r\nconst BASE_DIVISIONS = 72;\r\nconst DECLINATION_DIVISIONS = 12;\r\n\r\nconst Heliodon = ({\r\n                      hourAngle,\r\n                      declinationAngle,\r\n                      radius = 10,\r\n                      date = new Date(),\r\n                      latitude = 42 / 180.0 * Math.PI,\r\n                  }: HeliodonProps) => {\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            // remove listeners if any\r\n        }\r\n    }, [date, latitude]);\r\n\r\n    const nRibLines = 5;\r\n\r\n    const [basePositions, baseNormals, baseColors, tickPoints] = useMemo(() => {\r\n        const basePoints: Vector3[] = [];\r\n        const tickPoints: Vector3[] = [];\r\n        const step = Math.PI * 2 / BASE_DIVISIONS;\r\n        let counter = 0;\r\n        for (let angle = 0; angle < Util.TWO_PI + step / 2.0; angle += step) {\r\n            const theta = Math.min(angle, Util.TWO_PI);\r\n            let width = 0.05 * radius;\r\n            // TODO: This is inefficient. We should use indexed buffer to share vertices\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius, theta, 0)));\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius + width, theta, 0)));\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius, theta + step, 0)));\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius + width, theta, 0)));\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius + width, theta + step, 0)));\r\n            basePoints.push(Util.sphericalToCartesianZ(new Vector3(radius, theta + step, 0)));\r\n            let p;\r\n            if (Util.TWO_PI - theta > Util.ZERO_TOLERANCE) {\r\n                width = 0.05 * radius + (counter % 3 === 0 ? 0.2 : 0);\r\n                p = new Vector3(radius, theta, 0);\r\n                p.z = 0.002;\r\n                tickPoints.push(Util.sphericalToCartesianZ(p));\r\n                p = new Vector3(radius + width, theta, 0);\r\n                p.z = 0.002;\r\n                tickPoints.push(Util.sphericalToCartesianZ(p));\r\n            }\r\n            counter++;\r\n        }\r\n\r\n        // attributes\r\n        const length = basePoints.length * 3;\r\n        const basePositions = new Float32Array(length);\r\n        const baseNormals = new Float32Array(length);\r\n        const baseColors = new Float32Array(length);\r\n\r\n        for (let i = 0; i < basePoints.length; i++) {\r\n            const j = i * 3;\r\n            basePositions[j] = basePoints[i].x;\r\n            basePositions[j + 1] = basePoints[i].y;\r\n            basePositions[j + 2] = basePoints[i].z;\r\n            baseNormals[j] = 0;\r\n            baseNormals[j + 1] = 1;\r\n            baseNormals[j + 2] = 0;\r\n            const c = (Math.floor(i / 18)) % 2 === 0 ? 0.2 : 1.0;\r\n            baseColors[j] = c;\r\n            baseColors[j + 1] = c;\r\n            baseColors[j + 2] = c;\r\n        }\r\n\r\n        return [basePositions, baseNormals, baseColors, tickPoints];\r\n    }, [radius]);\r\n\r\n    const sunPathPoints = useMemo(() => {\r\n        const step = Util.TWO_PI / HOUR_DIVISIONS;\r\n        const points = [];\r\n        for (let h = -Math.PI; h < Math.PI + step / 2.0; h += step) {\r\n            const v = computeSunLocation(radius, h, declinationAngle, latitude);\r\n            if (v.z > -0.1) {\r\n                points.push(v);\r\n            }\r\n        }\r\n        return points;\r\n    }, [latitude, radius, declinationAngle]);\r\n\r\n    const getSunPathPointsByDate = (d: number) => {\r\n        const step = Util.TWO_PI / HOUR_DIVISIONS;\r\n        const points = [];\r\n        for (let h = -Math.PI; h < Math.PI + step / 2.0; h += step) {\r\n            const v = computeSunLocation(radius, h, d, latitude);\r\n            if (v.z > -0.1) {\r\n                points.push(v);\r\n            }\r\n        }\r\n        return points;\r\n    };\r\n\r\n    const pointArraySunPaths = useMemo(() => {\r\n        const dMin = computeDeclinationAngle(new Date(2021, 11, 22));\r\n        const dMax = computeDeclinationAngle(new Date(2021, 5, 22));\r\n        const delta = (dMax - dMin) / nRibLines;\r\n        const arr = [];\r\n        for (let i = 0; i <= nRibLines; i++) {\r\n            arr.push(getSunPathPointsByDate(dMin + i * delta));\r\n        }\r\n        return arr;\r\n    }, [latitude, radius]);\r\n\r\n    const sunPosition = useMemo(() => {\r\n        return computeSunLocation(radius, hourAngle, declinationAngle, latitude);\r\n    }, [latitude, declinationAngle, hourAngle, radius]);\r\n\r\n    const sunbeltGeometry = useMemo(() => {\r\n        const declinationStep = 2.0 * TILT_ANGLE / DECLINATION_DIVISIONS;\r\n        const hourStep = Util.TWO_PI / HOUR_DIVISIONS;\r\n        const geometry = new BufferGeometry();\r\n        let verticesCount = 0;\r\n        const vertices: Vector3[] = [];\r\n        const indices = [];\r\n        for (let d = -TILT_ANGLE; d < TILT_ANGLE - declinationStep / 2.0; d += declinationStep) {\r\n            for (let h = -Math.PI; h < Math.PI - hourStep / 2.0; h += hourStep) {\r\n                let h2 = h + hourStep;\r\n                let d2 = d + declinationStep;\r\n                if (h2 > Math.PI) {\r\n                    h2 = Math.PI;\r\n                }\r\n                if (d2 > TILT_ANGLE) {\r\n                    d2 = TILT_ANGLE;\r\n                }\r\n                const v1 = computeSunLocation(radius, h, d, latitude);\r\n                const v2 = computeSunLocation(radius, h2, d, latitude);\r\n                const v3 = computeSunLocation(radius, h2, d2, latitude);\r\n                const v4 = computeSunLocation(radius, h, d2, latitude);\r\n                if (v1.z >= 0 || v2.z >= 0 || v3.z >= 0 || v4.z >= 0) {\r\n                    vertices.push(v1, v2, v3, v4);\r\n                    indices.push(verticesCount);\r\n                    indices.push(verticesCount + 1);\r\n                    indices.push(verticesCount + 2);\r\n                    indices.push(verticesCount);\r\n                    indices.push(verticesCount + 2);\r\n                    indices.push(verticesCount + 3);\r\n                    verticesCount += 4;\r\n                }\r\n            }\r\n        }\r\n        geometry.setFromPoints(vertices);\r\n        geometry.setIndex(new BufferAttribute(new Uint16Array(indices), 1));\r\n        return geometry;\r\n    }, [latitude, radius]);\r\n\r\n    return (\r\n        <mesh rotation={new Euler(-Math.PI / 2, 0, 0)} name={'Heliodon'}>\r\n            {/* draw base */}\r\n            <mesh>\r\n                <bufferGeometry attach='geometry'>\r\n                    <bufferAttribute\r\n                        attachObject={[\"attributes\", \"position\"]}\r\n                        count={basePositions.length / 3}\r\n                        array={basePositions}\r\n                        itemSize={3}\r\n                    />\r\n                    <bufferAttribute\r\n                        attachObject={[\"attributes\", \"normal\"]}\r\n                        count={baseNormals.length / 3}\r\n                        array={baseNormals}\r\n                        itemSize={3}\r\n                    />\r\n                    <bufferAttribute\r\n                        attachObject={[\"attributes\", \"color\"]}\r\n                        count={baseColors.length / 3}\r\n                        array={baseColors}\r\n                        itemSize={3}\r\n                    />\r\n                </bufferGeometry>\r\n                <meshBasicMaterial side={DoubleSide}\r\n                                   vertexColors={true}\r\n                                   polygonOffset={true}\r\n                                   polygonOffsetFactor={-0.7}\r\n                                   polygonOffsetUnits={-2}/>\r\n            </mesh>\r\n            <lineSegments\r\n                args={[new BufferGeometry().setFromPoints(tickPoints),\r\n                    new MeshBasicMaterial({color: 0x000000})]}/>\r\n            {/* draw sun path*/}\r\n            <mesh>\r\n                {sunPathPoints.length > 3 && <Line lineWidth={2} points={sunPathPoints} color={'yellow'}/>}\r\n                {pointArraySunPaths\r\n                    .filter(a => a.length > 3)\r\n                    .map((a, index) => {\r\n                        return <Line key={index}\r\n                                     opacity={index === 0 || index === nRibLines ? 1 : 0.5}\r\n                                     lineWidth={index === 0 || index === nRibLines ? 1 : 0.5}\r\n                                     points={a}\r\n                                     color={'#999'}/>;\r\n                    })\r\n                }\r\n                <mesh\r\n                    args={[sunbeltGeometry,\r\n                        new MeshBasicMaterial({\r\n                            side: DoubleSide,\r\n                            color: new Color(1, 1, 0),\r\n                            transparent: true,\r\n                            opacity: 0.5,\r\n                            clippingPlanes: [new Plane(Util.UNIT_VECTOR_POS_Y, 0)]\r\n                        })\r\n                    ]}\r\n                />\r\n                <mesh\r\n                    position={sunPosition}\r\n                    args={[new SphereGeometry(0.25, 20, 20),\r\n                        new MeshBasicMaterial({color: 0xffffff00})\r\n                    ]}\r\n                />\r\n            </mesh>\r\n        </mesh>\r\n    );\r\n\r\n};\r\n\r\nexport default Heliodon;\r\n","export default __webpack_public_path__ + \"static/media/aladdin-logo.96b59d24.png\";","export default __webpack_public_path__ + \"static/media/ifi-logo.eb360016.png\";","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from \"react\";\r\n\r\nexport const SYMBOLS = [\r\n    'circle',\r\n    'square',\r\n    'triangle up',\r\n    'triangle down',\r\n    'triangle right',\r\n    'triangle left',\r\n    'star',\r\n    'diamond',\r\n    'hexagon'\r\n];\r\n\r\nexport enum Direction {\r\n    DOWN, UP, LEFT, RIGHT\r\n}\r\n\r\nconst strokeWidth = 1;\r\n\r\nexport const CircleSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        return (\r\n            <svg x={cx - 10 * scale} y={cy - 10 * scale} width={20 * scale} height={20 * scale} viewBox=\"-10 -10 20 20\">\r\n                <circle cx=\"0\" cy=\"0\" r=\"3\"\r\n                        style={{opacity: opacity, stroke: stroke, fill: 'white', strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const SquareSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        return (\r\n            <svg x={cx - 10 * scale} y={cy - 10 * scale} width={20 * scale} height={20 * scale} viewBox=\"-10 -10 20 20\">\r\n                <rect x=\"-3\" y=\"-3\" width=\"6\" height=\"6\"\r\n                      style={{opacity: opacity, stroke: stroke, fill: 'white', strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const TriangleSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols, direction} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        let pointsString;\r\n        switch (direction) {\r\n            case Direction.UP:\r\n                pointsString = \"-4,2.5,4,2.5,0,-3.5\";\r\n                break;\r\n            case Direction.LEFT:\r\n                pointsString = \"2.5,4,2.5,-4,-3.5,0\";\r\n                break;\r\n            case Direction.RIGHT:\r\n                pointsString = \"-2.5,4,-2.5,-4,3.5,0\";\r\n                break;\r\n            default:\r\n                pointsString = \"-4,-2.5,4,-2.5,0,3.5\";\r\n        }\r\n        // strokeWidth needs to be halved as the view box is too small\r\n        return (\r\n            <svg x={cx - 10 * scale} y={cy - 10 * scale} width={20 * scale} height={20 * scale} viewBox=\"-10 -10 20 20\">\r\n                <polygon points={pointsString}\r\n                         style={{opacity: opacity, stroke: stroke, fill: 'white', strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const DiamondSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        // strokeWidth needs to be halved as the view box is too small\r\n        return (\r\n            <svg x={cx - 10 * scale} y={cy - 10 * scale} width={20 * scale} height={20 * scale} viewBox=\"-10 -10 20 20\">\r\n                <polygon points=\"-3,0,0,5,3,0,0,-5\"\r\n                         style={{opacity: opacity, stroke: stroke, fill: 'white', strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const StarSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        // we need to scale down by 50% first before applying the scale factor as the original svg is too large\r\n        const s = 0.05 * scale;\r\n        return (\r\n            // strokeWidth needs to be doubled as the view box is too large\r\n            <svg x={cx - 100 * s} y={cy - 100 * s} width={300 * s} height={300 * s} viewBox=\"0 0 300 300\">\r\n                <polygon points=\"100,10 40,180 190,60 10,60 160,180\"\r\n                         style={{opacity: opacity, stroke: stroke, fill: stroke, strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const HexagonSymbol = (props: any) => {\r\n    const {cx, cy, opacity, stroke, index, points, scale, numberOfSymbols} = props;\r\n    const interval = Math.round(points.length / numberOfSymbols);\r\n    if (cx && cy && index > 0 && index % interval === 0) {\r\n        const s = 0.02 * scale;\r\n        return (\r\n            <svg x={cx - 150 * s} y={cy - 150 * s} width={300 * s} height={300 * s} viewBox=\"0 0 300 300\">\r\n                <polygon className=\"hex\" points=\"300,150 225,280 75,280 0,150 75,20 225,20\"\r\n                         style={{opacity: opacity, stroke: stroke, fill: 'white', strokeWidth: strokeWidth}}/>\r\n            </svg>\r\n        );\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const createSymbol = (type: string, size: number, count: number, opacity: number) => {\r\n    switch (type) {\r\n        case 'circle':\r\n            return <CircleSymbol scale={size} numberOfSymbols={count} opacity={opacity}/>;\r\n        case 'square':\r\n            return <SquareSymbol scale={size} numberOfSymbols={count} opacity={opacity}/>;\r\n        case 'triangle up':\r\n            return <TriangleSymbol scale={1.1 * size} numberOfSymbols={count} direction={Direction.UP} opacity={opacity}/>;\r\n        case 'triangle down':\r\n            return <TriangleSymbol scale={1.1 * size} numberOfSymbols={count} direction={Direction.DOWN} opacity={opacity}/>;\r\n        case 'triangle right':\r\n            return <TriangleSymbol scale={1.1 * size} numberOfSymbols={count} direction={Direction.RIGHT} opacity={opacity}/>;\r\n        case 'triangle left':\r\n            return <TriangleSymbol scale={1.1 * size} numberOfSymbols={count} direction={Direction.LEFT} opacity={opacity}/>;\r\n        case 'star':\r\n            return <StarSymbol scale={1.25 * size} numberOfSymbols={count} opacity={opacity}/>;\r\n        case 'diamond':\r\n            return <DiamondSymbol scale={1.1 * size} numberOfSymbols={count} opacity={opacity}/>;\r\n        case 'hexagon':\r\n            return <HexagonSymbol scale={1.3 * size} numberOfSymbols={count} opacity={opacity}/>;\r\n    }\r\n};\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport {useStore} from \"./stores/common\";\r\nimport styled from 'styled-components';\r\nimport {Menu, Dropdown, Checkbox} from 'antd';\r\nimport {ReactComponent as MenuSVG} from './assets/menu.svg';\r\nimport 'antd/dist/antd.css';\r\n\r\nconst {SubMenu} = Menu;\r\n\r\nconst StyledMenuSVG = styled(MenuSVG)`\r\n  position: absolute;\r\n  top: 10px;\r\n  left: 10px;\r\n  height: 40px;\r\n  width: 40px;\r\n  transition: 0.5s;\r\n  fill: brown;\r\n\r\n  &:hover {\r\n    fill: white;\r\n  }\r\n`;\r\n\r\nexport interface MainMenuProps {\r\n\r\n    collectDailyLightSensorData: () => void;\r\n    collectYearlyLightSensorData: () => void;\r\n    openAboutUs: (on: boolean) => void;\r\n\r\n    [key: string]: any;\r\n\r\n}\r\n\r\nconst MainMenu = ({\r\n                      collectDailyLightSensorData,\r\n                      collectYearlyLightSensorData,\r\n                      openAboutUs,\r\n                      ...rest\r\n                  }: MainMenuProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const showGroundPanel = useStore(state => state.showGroundPanel);\r\n    const showWeatherPanel = useStore(state => state.showWeatherPanel);\r\n    const showHeliodonPanel = useStore(state => state.showHeliodonPanel);\r\n\r\n    // @ts-ignore\r\n    const onChangeShowGroundPanel = (e) => {\r\n        setCommonStore((state) => {\r\n            state.showGroundPanel = e.target.checked;\r\n        });\r\n    };\r\n\r\n    // @ts-ignore\r\n    const onChangeShowWeatherPanel = (e) => {\r\n        setCommonStore((state) => {\r\n            state.showWeatherPanel = e.target.checked;\r\n        });\r\n    };\r\n\r\n    const menu = (\r\n        <Menu>\r\n            <Menu.Item key={'ground-panel-check-box'}>\r\n                <Checkbox checked={showGroundPanel} onChange={onChangeShowGroundPanel}>\r\n                    Ground Settings\r\n                </Checkbox>\r\n            </Menu.Item>\r\n            <Menu.Item key={'weather-panel-check-box'}>\r\n                <Checkbox checked={showWeatherPanel} onChange={onChangeShowWeatherPanel}>\r\n                    Weather Data\r\n                </Checkbox>\r\n            </Menu.Item>\r\n            <SubMenu key={'sensors'} title={'Sensors'}>\r\n                <Menu.Item key={'sensor-collect-daily-data'} onClick={collectDailyLightSensorData}>\r\n                    Collect Daily Data\r\n                </Menu.Item>\r\n                <Menu.Item key={'sensor-collect-yearly-data'} onClick={collectYearlyLightSensorData}>\r\n                    Collect Yearly Data\r\n                </Menu.Item>\r\n            </SubMenu>\r\n            <Menu.Item key={'about-us'} onClick={() => {\r\n                openAboutUs(true);\r\n            }}>\r\n                About Us\r\n            </Menu.Item>\r\n        </Menu>\r\n    );\r\n\r\n    return (\r\n        <Dropdown overlay={menu} trigger={['click']}>\r\n            <StyledMenuSVG/>\r\n        </Dropdown>\r\n    );\r\n};\r\n\r\nexport default MainMenu;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {memo, useCallback, useEffect, useRef, useState} from \"react\";\r\nimport {GoogleMap, Marker} from '@react-google-maps/api';\r\nimport {useStore} from \"../stores/common\";\r\n\r\nexport interface MapsProp {\r\n\r\n    setLatitude?: (value: number) => void;\r\n    setLongitude?: (value: number) => void;\r\n    setZoom?: (value: number) => void;\r\n    setTilt?: (value: number) => void;\r\n    setType?: (value: string) => void;\r\n\r\n}\r\n\r\nconst containerStyle = {\r\n    border: '1px solid',\r\n    width: '400px',\r\n    height: '400px'\r\n};\r\n\r\nconst Maps = ({\r\n                  setLatitude,\r\n                  setLongitude,\r\n                  setZoom,\r\n                  setTilt,\r\n                  setType,\r\n              }: MapsProp) => {\r\n\r\n    const latitude = useStore(state => state.latitude);\r\n    const longitude = useStore(state => state.longitude);\r\n    const zoom = useStore(state => state.mapZoom);\r\n    const type = useStore(state => state.mapType);\r\n    const tilt = useStore(state => state.mapTilt);\r\n    const [map, setMap] = useState<google.maps.Map | null>(null);\r\n    const bounds = useRef<google.maps.LatLngBounds | null | undefined>();\r\n    const cities = useRef<google.maps.LatLng[]>([]);\r\n    const weatherData = useStore(state => state.weatherData);\r\n    const mapWeatherStations = useStore(state => state.mapWeatherStations);\r\n    const [updateFlag, setUpdateFlag] = useState<boolean>(false);\r\n\r\n    useEffect(() => {\r\n    }, [updateFlag]);\r\n\r\n    const onLoad = useCallback((map: google.maps.Map) => {\r\n        setMap(map);\r\n    }, []);\r\n\r\n    const onUnmount = useCallback(function callback(map) {\r\n        setMap(null);\r\n    }, []);\r\n\r\n    const loadCities = () => {\r\n        if (bounds.current) {\r\n            cities.current.length = 0;\r\n            for (const x in weatherData) {\r\n                if (weatherData.hasOwnProperty(x)) {\r\n                    const w = weatherData[x];\r\n                    const pos = new google.maps.LatLng(w.latitude, w.longitude);\r\n                    if (bounds.current.contains(pos)) {\r\n                        cities.current.push(pos);\r\n                    }\r\n                }\r\n            }\r\n            setUpdateFlag(!updateFlag);\r\n        }\r\n    };\r\n\r\n    const onBoundsChanged = () => {\r\n        if (map) {\r\n            bounds.current = map.getBounds();\r\n            if (mapWeatherStations) {\r\n                loadCities();\r\n            }\r\n        }\r\n    };\r\n\r\n    const onCenterChanged = () => {\r\n        if (map) {\r\n            const center = map.getCenter();\r\n            const lat = center.lat();\r\n            if (lat !== latitude) {\r\n                setLatitude?.(lat);\r\n            }\r\n            const lng = center.lng();\r\n            if (lng !== longitude) {\r\n                setLongitude?.(lng);\r\n            }\r\n        }\r\n    };\r\n\r\n    const onZoomChanged = () => {\r\n        if (map) {\r\n            const z = map.getZoom();\r\n            if (z !== zoom) {\r\n                setZoom?.(z);\r\n            }\r\n        }\r\n    };\r\n\r\n    const onTiltChanged = () => {\r\n        if (map) {\r\n            const t = map.getTilt();\r\n            if (t !== tilt) {\r\n                setTilt?.(t);\r\n            }\r\n        }\r\n    };\r\n\r\n    const onMapTypeIdChanged = () => {\r\n        if (map) {\r\n            const typeId = map.getMapTypeId();\r\n            if (typeId !== type) {\r\n                setType?.(typeId);\r\n            }\r\n        }\r\n    };\r\n\r\n    const latLng = {lat: latitude, lng: longitude};\r\n\r\n    return (\r\n        <GoogleMap\r\n            mapContainerStyle={containerStyle}\r\n            mapTypeId={type}\r\n            center={latLng}\r\n            zoom={zoom}\r\n            tilt={tilt}\r\n            onLoad={onLoad}\r\n            onBoundsChanged={onBoundsChanged}\r\n            onUnmount={onUnmount}\r\n            onCenterChanged={onCenterChanged}\r\n            onZoomChanged={onZoomChanged}\r\n            onTiltChanged={onTiltChanged}\r\n            onMapTypeIdChanged={onMapTypeIdChanged}\r\n        >\r\n            { /* Child components, such as markers, info windows, etc. */}\r\n            <>\r\n                {mapWeatherStations &&\r\n                cities.current.map((c, index) => {\r\n                    const scale = 0.2 * zoom;\r\n                    return (\r\n                        <Marker\r\n                            key={index}\r\n                            icon={{\r\n                                path: google.maps.SymbolPath.CIRCLE,\r\n                                strokeColor: 'red',\r\n                                strokeWeight: scale + 2,\r\n                                scale: scale,\r\n                            }}\r\n                            position={c}\r\n                        />\r\n                    )\r\n                })}\r\n            </>\r\n        </GoogleMap>\r\n    );\r\n};\r\n\r\nexport default memo(Maps);\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {Spin} from 'antd';\r\nimport styled from 'styled-components';\r\n\r\nexport default styled(Spin)`\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: rgba(255, 255, 255, 0.5);\r\n  z-index: 999;\r\n`;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useRef, useState} from 'react';\r\nimport {useStore} from \"../stores/common\";\r\nimport styled from 'styled-components';\r\nimport {Space, Switch} from \"antd\";\r\nimport {CompactPicker} from 'react-color';\r\nimport Maps from \"../components/maps\";\r\nimport {StandaloneSearchBox, useJsApiLoader} from \"@react-google-maps/api\";\r\nimport {Libraries} from \"@react-google-maps/api/dist/utils/make-load-script-url\";\r\nimport Spinner from '../components/spinner';\r\nimport ReactDraggable, {DraggableEventHandler} from \"react-draggable\";\r\nimport 'antd/dist/antd.css';\r\n\r\nconst libraries = ['places'] as Libraries;\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 10px;\r\n  left: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nconst ColumnWrapper = styled.div`\r\n  background-color: #f8f8f8;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 420px;\r\n  padding-bottom: 10px;\r\n  border: 2px solid gainsboro;\r\n  border-radius: 10px 10px 10px 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  border-radius: 10px 10px 0 0;\r\n  width: 100%;\r\n  height: 24px;\r\n  padding: 10px;\r\n  background-color: #e8e8e8;\r\n  color: #888;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: move;\r\n\r\n  svg.icon {\r\n    height: 16px;\r\n    width: 16px;\r\n    padding: 8px;\r\n    fill: #666;\r\n  }\r\n`;\r\n\r\nexport interface GroundPanelProps {\r\n    grid: boolean;\r\n    groundImage: boolean;\r\n    groundColor: string;\r\n    setGrid?: (on: boolean) => void;\r\n    setGroundImage?: (on: boolean) => void;\r\n    setGroundColor?: (color: string) => void;\r\n    changeLatitude?: (latitude: number) => void;\r\n    changeLongitude?: (longitude: number) => void;\r\n    changeMapZoom?: (zoom: number) => void;\r\n    changeMapTilt?: (tilt: number) => void;\r\n    changeMapType?: (type: string) => void;\r\n}\r\n\r\nconst GroundPanel = ({\r\n                         grid,\r\n                         groundImage,\r\n                         groundColor,\r\n                         setGrid,\r\n                         setGroundImage,\r\n                         setGroundColor,\r\n                         changeLatitude,\r\n                         changeLongitude,\r\n                         changeMapZoom,\r\n                         changeMapTilt,\r\n                         changeMapType,\r\n                     }: GroundPanelProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const latitude = useStore(state => state.latitude);\r\n    const longitude = useStore(state => state.longitude);\r\n    const mapZoom = useStore(state => state.mapZoom);\r\n    const mapWeatherStations = useStore(state => state.mapWeatherStations);\r\n    const address = useStore(state => state.address);\r\n    const searchBox = useRef<google.maps.places.SearchBox>();\r\n    const [curPosition, setCurPosition] = useState({x: 0, y: 0});\r\n\r\n    const {isLoaded, loadError} = useJsApiLoader({\r\n        id: 'google-map-script',\r\n        googleMapsApiKey: process.env.REACT_APP_MAPS_API_KEY as string,\r\n        libraries: libraries\r\n    });\r\n\r\n    const onPlacesChanged = () => {\r\n        const places = searchBox.current?.getPlaces();\r\n        if (places && places.length > 0) {\r\n            setCommonStore((state) => {\r\n                const geometry = places[0].geometry;\r\n                if (geometry) {\r\n                    state.latitude = geometry.location.lat();\r\n                    state.longitude = geometry.location.lng();\r\n                }\r\n                state.address = places[0].formatted_address as string;\r\n            });\r\n        }\r\n    };\r\n\r\n    const onLoad = (s: google.maps.places.SearchBox) => {\r\n        searchBox.current = s;\r\n    };\r\n\r\n    const setMapWeatherStations = (on: boolean) => {\r\n        setCommonStore(state => {\r\n            state.mapWeatherStations = on;\r\n        });\r\n    };\r\n\r\n    const onDrag: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n        setCurPosition({\r\n            x: ui.x,\r\n            y: ui.y,\r\n        });\r\n    };\r\n\r\n    const onDragStart: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    const onDragEnd: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    return (\r\n        <ReactDraggable\r\n            handle={'.handle'}\r\n            bounds={'parent'}\r\n            axis='both'\r\n            position={curPosition}\r\n            onDrag={onDrag}\r\n            onStart={onDragStart}\r\n            onStop={onDragEnd}\r\n        >\r\n            <Container>\r\n                <ColumnWrapper>\r\n                    <Header className='handle'>\r\n                        <span>Ground Settings</span>\r\n                        <span style={{cursor: 'pointer'}} onClick={() => {\r\n                            setCommonStore((state) => {\r\n                                state.showGroundPanel = false;\r\n                            });\r\n                        }}>Close</span>\r\n                    </Header>\r\n                    <Space direction={'vertical'}>\r\n                        <Space style={{padding: '20px'}} align={'center'} size={20}>\r\n                            <Space direction={'vertical'}>\r\n                                <Space>\r\n                                    <Space style={{width: '60px'}}>Grid:</Space>\r\n                                    <Switch title={'Show ground grid'}\r\n                                            checked={grid}\r\n                                            onChange={(checked) => {\r\n                                                setGrid?.(checked);\r\n                                            }}\r\n                                    />\r\n                                </Space>\r\n                                <Space>\r\n                                    <Space style={{width: '60px'}}>Image:</Space>\r\n                                    <Switch title={'Show ground image'}\r\n                                            checked={groundImage}\r\n                                            onChange={(checked) => {\r\n                                                setGroundImage?.(checked);\r\n                                            }}\r\n                                    />\r\n                                </Space>\r\n                                <Space>\r\n                                    <Space style={{width: '60px'}}>Stations:</Space>\r\n                                    <Switch title={'Show weather stations'}\r\n                                            checked={mapWeatherStations}\r\n                                            onChange={(checked) => {\r\n                                                setMapWeatherStations(checked);\r\n                                            }}\r\n                                    />\r\n                                </Space>\r\n                            </Space>\r\n                            <div>Ground Color<br/>\r\n                                <CompactPicker color={groundColor} onChangeComplete={(colorResult) => {\r\n                                    setGroundColor?.(colorResult.hex);\r\n                                }}/>\r\n                            </div>\r\n                        </Space>\r\n                        {isLoaded &&\r\n                        <Space>\r\n                            <div>\r\n                                <StandaloneSearchBox onLoad={onLoad}\r\n                                                     onPlacesChanged={onPlacesChanged}>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        placeholder={address}\r\n                                        style={{\r\n                                            boxSizing: `border-box`,\r\n                                            border: `1px solid transparent`,\r\n                                            width: `400px`,\r\n                                            height: `32px`,\r\n                                            padding: `0 12px`,\r\n                                            borderRadius: `3px`,\r\n                                            boxShadow: `0 2px 6px rgba(0, 0, 0, 0.3)`,\r\n                                            fontSize: `14px`,\r\n                                            outline: `none`,\r\n                                            textOverflow: `ellipses`,\r\n                                            position: \"relative\"\r\n                                        }}\r\n                                    />\r\n                                </StandaloneSearchBox>\r\n                            </div>\r\n                        </Space>\r\n                        }\r\n                        {isLoaded ?\r\n                            <Space>\r\n                                <div>\r\n                                    <Maps setLatitude={changeLatitude}\r\n                                          setLongitude={changeLongitude}\r\n                                          setZoom={changeMapZoom}\r\n                                          setTilt={changeMapTilt}\r\n                                          setType={changeMapType}\r\n                                    />\r\n                                    Coordinates: ({latitude.toFixed(4)}, {longitude.toFixed(4)}),\r\n                                    Zoom: {mapZoom}\r\n                                </div>\r\n                            </Space>\r\n                            :\r\n                            <Spinner/>\r\n                        }\r\n                        {loadError &&\r\n                        <Space>\r\n                            <div>Map cannot be loaded right now, sorry.</div>\r\n                        </Space>\r\n                        }\r\n                    </Space>\r\n                </ColumnWrapper>\r\n            </Container>\r\n        </ReactDraggable>\r\n    );\r\n};\r\n\r\nexport default GroundPanel;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport {useStore} from \"../stores/common\";\r\nimport styled from 'styled-components';\r\nimport {Space, Switch, Slider, DatePicker, TimePicker} from \"antd\";\r\nimport moment from 'moment';\r\nimport 'antd/dist/antd.css';\r\nimport ReactDraggable, {DraggableEventHandler} from \"react-draggable\";\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 80px;\r\n  left: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nconst ColumnWrapper = styled.div`\r\n  background-color: #f8f8f8;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  width: 640px;\r\n  padding: 0;\r\n  border: 2px solid gainsboro;\r\n  border-radius: 10px 10px 10px 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  border-radius: 10px 10px 0 0;\r\n  width: 100%;\r\n  height: 24px;\r\n  padding: 10px;\r\n  background-color: #e8e8e8;\r\n  color: #888;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: move;\r\n\r\n  svg.icon {\r\n    height: 16px;\r\n    width: 16px;\r\n    padding: 8px;\r\n    fill: #666;\r\n  }\r\n`;\r\n\r\nexport interface HeliodonPanelProps {\r\n    heliodon: boolean;\r\n    latitude: number;\r\n    date: Date;\r\n    animateSun?: boolean;\r\n    setHeliodon?: (on: boolean) => void;\r\n    setSunAnimation?: (on: boolean) => void;\r\n    changeLatitude?: (latitude: number) => void;\r\n    changeDate?: (date: Date) => void;\r\n    changeTime?: (date: Date) => void;\r\n}\r\n\r\nconst HeliodonPanel = ({\r\n                           heliodon,\r\n                           latitude,\r\n                           date,\r\n                           animateSun,\r\n                           setHeliodon,\r\n                           setSunAnimation,\r\n                           changeLatitude,\r\n                           changeDate,\r\n                           changeTime,\r\n                       }: HeliodonPanelProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const requestRef = useRef<number>(0);\r\n    const previousFrameTime = useRef<number>(-1);\r\n    const [curPosition, setCurPosition] = useState({x: 0, y: 0});\r\n\r\n    useEffect(() => {\r\n        requestRef.current = requestAnimationFrame(animate);\r\n        return () => {\r\n            cancelAnimationFrame(requestRef.current);\r\n        }\r\n    }, [animateSun]);\r\n\r\n    const animate = () => {\r\n        if (animateSun) {\r\n            requestRef.current = requestAnimationFrame(animate);\r\n            const currentFrameTime = Date.now();\r\n            if (currentFrameTime - previousFrameTime.current > 100) {\r\n                const day = date.getDate();\r\n                date.setHours(date.getHours(), date.getMinutes() + 15);\r\n                date.setDate(day)\r\n                changeTime?.(date);\r\n                previousFrameTime.current = currentFrameTime;\r\n            }\r\n        }\r\n    };\r\n\r\n    const onDrag: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n        setCurPosition({\r\n            x: ui.x,\r\n            y: ui.y,\r\n        });\r\n    };\r\n\r\n    const onDragStart: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    const onDragEnd: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    return (\r\n        <ReactDraggable\r\n            handle={'.handle'}\r\n            bounds={'parent'}\r\n            axis='both'\r\n            position={curPosition}\r\n            onDrag={onDrag}\r\n            onStart={onDragStart}\r\n            onStop={onDragEnd}\r\n        >\r\n            <Container>\r\n                <ColumnWrapper>\r\n                    <Header className='handle'>\r\n                        <span>Heliodon Settings</span>\r\n                        <span style={{cursor: 'pointer'}} onClick={() => {\r\n                            setCommonStore((state) => {\r\n                                state.showHeliodonPanel = false;\r\n                            });\r\n                        }}>Close</span>\r\n                    </Header>\r\n                    <Space style={{padding: '20px'}} align={'baseline'} size={20}>\r\n                        <div>\r\n                            Show<br/>\r\n                            <Switch checked={heliodon} onChange={(checked) => {\r\n                                setHeliodon?.(checked);\r\n                            }}/>\r\n                        </div>\r\n                        <div>\r\n                            Animate<br/>\r\n                            <Switch checked={animateSun} onChange={(checked) => {\r\n                                setSunAnimation?.(checked);\r\n                            }}/>\r\n                        </div>\r\n                        <div>\r\n                            Date<br/>\r\n                            <DatePicker value={moment(date)}\r\n                                        onChange={(moment) => {\r\n                                            if (moment) changeDate?.(moment.toDate());\r\n                                        }}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            Time<br/>\r\n                            <TimePicker value={moment(date, 'HH:mm')}\r\n                                        format={'HH:mm'}\r\n                                        onChange={(moment) => {\r\n                                            if (moment) changeTime?.(moment.toDate());\r\n                                        }}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            Latitude: {latitude.toFixed(4)}\r\n                            <Slider\r\n                                style={{width: '150px'}}\r\n                                marks={{'-90': '-90', 0: '0', 90: '90'}}\r\n                                min={-90}\r\n                                max={90}\r\n                                tooltipVisible={false}\r\n                                defaultValue={latitude}\r\n                                onChange={(value: number) => {\r\n                                    changeLatitude?.(value);\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    </Space>\r\n                </ColumnWrapper>\r\n            </Container>\r\n        </ReactDraggable>\r\n    );\r\n};\r\n\r\nexport default HeliodonPanel;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nexport const VERSION = '0.0.1';\r\n\r\nexport const isProd = process.env.NODE_ENV === 'production';\r\n\r\nexport const HOME_URL: string = isProd ? 'https://aladdin.intofuture.org' : 'http://aladdin.dev';\r\n\r\nexport const PRESET_COLORS = [\r\n    '#8884d8',\r\n    '#f97356',\r\n    '#1bc32c',\r\n    '#c6502d',\r\n    '#82ca9d',\r\n    '#3eaec0',\r\n    '#627682',\r\n    '#445111'\r\n];\r\n\r\nexport const MONTHS = [\r\n    'Jan',\r\n    'Feb',\r\n    'Mar',\r\n    'Apr',\r\n    'May',\r\n    'Jun',\r\n    'Jul',\r\n    'Aug',\r\n    'Sep',\r\n    'Oct',\r\n    'Nov',\r\n    'Dec'\r\n];\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport {message} from \"antd\";\r\n\r\nexport const visitIFI = () => {\r\n    window.open(\"https://intofuture.org\", '_blank');\r\n};\r\n\r\nexport const getMapImage = (size: number, lat: number, lng: number, zoom: number) => {\r\n    return \"https://maps.googleapis.com/maps/api/staticmap?maptype=satellite&center=\" + lat + \",\" + lng\r\n        + \"&zoom=\" + zoom + \"&size=\" + size + \"x\" + size + \"&scale=2&key=\" + process.env.REACT_APP_MAPS_API_KEY;\r\n}\r\n\r\nexport const showSuccess = (msg: string) => {\r\n    message.success({\r\n        content: msg,\r\n        className: 'custom-class',\r\n        style: {\r\n            marginTop: '20vh',\r\n        },\r\n        onClick: () => {\r\n            message.destroy();\r\n        }\r\n    });\r\n};\r\n\r\nexport const showInfo = (msg: string) => {\r\n    message.info({\r\n        content: msg,\r\n        className: 'custom-class',\r\n        style: {\r\n            marginTop: '20vh',\r\n        },\r\n        onClick: () => {\r\n            message.destroy();\r\n        }\r\n    });\r\n};\r\n\r\nexport const showWarning = (msg: string) => {\r\n    message.warning({\r\n        content: msg,\r\n        className: 'custom-class',\r\n        style: {\r\n            marginTop: '20vh',\r\n        },\r\n        onClick: () => {\r\n            message.destroy();\r\n        }\r\n    });\r\n};\r\n\r\nexport const showError = (msg: string) => {\r\n    message.error({\r\n        content: msg,\r\n        className: 'custom-class',\r\n        style: {\r\n            marginTop: '20vh',\r\n        },\r\n        onClick: () => {\r\n            message.destroy();\r\n        }\r\n    });\r\n};\r\n\r\nexport const fahrenheitToCelsius = (temp: number) => {\r\n    return ((temp - 32) * 5) / 9;\r\n};\r\n\r\nexport const celsiusToFahrenheit = (temp: number) => {\r\n    return temp * (9 / 5) + 32;\r\n};\r\n\r\nexport const openInNewTab = (url: string) => {\r\n    const win = window.open(url, '_blank');\r\n    if (win) {\r\n        win.focus();\r\n    }\r\n};\r\n\r\nexport const extractText = (html: string) => {\r\n    return new DOMParser().parseFromString(html, \"text/html\").documentElement.textContent;\r\n};\r\n\r\nexport const containedInDOMRect = (rect: DOMRect, x: number, y: number, margin: number) => {\r\n    return x > rect.x - margin && x < rect.x + rect.width + margin\r\n        && y > rect.y - margin && y < rect.y + rect.height + margin;\r\n};\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport CookieConsent from \"react-cookie-consent\";\r\n\r\nconst AcceptCookie = () => {\r\n    return <CookieConsent\r\n        location=\"bottom\"\r\n        buttonText=\"Accept\"\r\n        cookieName=\"AladdinCookieName\"\r\n        style={{background: \"#2B373B\", textAlign: 'center', zIndex: 99999}}\r\n        buttonStyle={{color: \"#4e503b\", fontSize: \"12px\"}}\r\n        expires={150}\r\n    >\r\n        By clicking Accept, you agree to our use of cookies to improve your experience with Aladdin.\r\n    </CookieConsent>;\r\n};\r\n\r\nexport default AcceptCookie;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from \"react\";\r\nimport {useTexture} from \"@react-three/drei\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {DoubleSide} from \"three\";\r\nimport {getMapImage} from \"../helpers\";\r\n\r\nconst GroundImage = () => {\r\n\r\n    const latitude = useStore(state => state.latitude);\r\n    const longitude = useStore(state => state.longitude);\r\n    const mapZoom = useStore(state => state.mapZoom);\r\n\r\n    const texture = useTexture(getMapImage(640, latitude, longitude, mapZoom));\r\n\r\n    return (\r\n        <mesh rotation={[-Math.PI / 2, 0, 0]} position={[0, 0, 0]}>\r\n            <planeBufferGeometry args={[100, 100]}/>\r\n            <meshStandardMaterial attach=\"material\" side={DoubleSide} map={texture} opacity={1}/>\r\n        </mesh>\r\n    )\r\n};\r\n\r\nexport default GroundImage;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport styled from \"styled-components\";\r\nimport 'antd/dist/antd.css';\r\nimport {useStore} from \"./stores/common\";\r\nimport {useWorker} from \"@koale/useworker\";\r\nimport {Menu, Checkbox, Radio} from 'antd';\r\nimport {ObjectType, Theme} from \"./types\";\r\n\r\n// TODO: Reduce the space between menu items\r\nconst StyledMenu = styled(Menu)`\r\n  padding: 0;\r\n  margin: 0;\r\n`;\r\n\r\nconst {SubMenu} = StyledMenu;\r\n\r\nconst radioStyle = {\r\n    display: 'block',\r\n    height: '30px',\r\n    paddingLeft: '10px',\r\n    lineHeight: '30px',\r\n};\r\n\r\nexport interface ContextMenuProps {\r\n\r\n    city: string | null;\r\n    collectDailyLightSensorData: () => void;\r\n    collectYearlyLightSensorData: () => void;\r\n\r\n    [key: string]: any;\r\n\r\n}\r\n\r\nconst ContextMenu = ({\r\n                         city,\r\n                         collectDailyLightSensorData,\r\n                         collectYearlyLightSensorData,\r\n                         ...rest\r\n                     }: ContextMenuProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const getSelectedElement = useStore(state => state.getSelectedElement);\r\n    const updateElementById = useStore(state => state.updateElementById);\r\n    const axes = useStore(state => state.axes);\r\n    const grid = useStore(state => state.grid);\r\n    const theme = useStore(state => state.theme);\r\n    const showHeliodonPanel = useStore(state => state.showHeliodonPanel);\r\n    const showGroundPanel = useStore(state => state.showGroundPanel);\r\n    const showWeatherPanel = useStore(state => state.showWeatherPanel);\r\n    const clickObjectType = useStore(state => state.clickObjectType);\r\n    const selectedElement = getSelectedElement();\r\n\r\n    switch (selectedElement ? selectedElement.type : clickObjectType) {\r\n        case ObjectType.Sky:\r\n            return (\r\n                <StyledMenu style={{padding: 0, margin: 0}}>\r\n                    <Menu.Item key={'axes'}>\r\n                        <Checkbox checked={axes} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.axes = e.target.checked;\r\n                            });\r\n                        }}>\r\n                            Axes\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'heliodon-settings'}>\r\n                        <Checkbox checked={showHeliodonPanel} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.showHeliodonPanel = e.target.checked;\r\n                            });\r\n                        }}>\r\n                            Heliodon Settings\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'weather-data'}>\r\n                        <Checkbox checked={showWeatherPanel} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.showWeatherPanel = e.target.checked;\r\n                            });\r\n                        }}>\r\n                            Weather Data\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <SubMenu key={'theme'} title={'Theme'}>\r\n                        <Radio.Group value={theme} style={{height: '105px'}} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.theme = e.target.value;\r\n                            });\r\n                        }}>\r\n                            <Radio style={radioStyle} value={Theme.Default}>Default</Radio>\r\n                            <Radio style={radioStyle} value={Theme.Desert}>Desert</Radio>\r\n                            <Radio style={radioStyle} value={Theme.Grassland}>Grassland</Radio>\r\n                        </Radio.Group>\r\n                    </SubMenu>\r\n                </StyledMenu>);\r\n        case ObjectType.Foundation:\r\n            return (\r\n                <StyledMenu>\r\n                    <Menu.Item key={'foundation-copy'}>\r\n                        Copy\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'foundation-cut'}>\r\n                        Cut\r\n                    </Menu.Item>\r\n                </StyledMenu>\r\n            );\r\n        case ObjectType.Sensor:\r\n            return (\r\n                <StyledMenu>\r\n                    <Menu.Item key={'sensor-copy'}>\r\n                        Copy\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'sensor-cut'}>\r\n                        Cut\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'sensor-light'}>\r\n                        <Checkbox checked={!!selectedElement?.showLabel} onChange={(e) => {\r\n                            if (selectedElement) {\r\n                                updateElementById(selectedElement.id, {showLabel: e.target.checked});\r\n                            }\r\n                        }}>\r\n                            Show Label\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <SubMenu key={'analysis'} title={'Analysis'}>\r\n                        <Menu.Item key={'sensor-collect-daily-data'} onClick={collectDailyLightSensorData}>\r\n                            Collect Daily Data\r\n                        </Menu.Item>\r\n                        <Menu.Item key={'sensor-collect-yearly-data'} onClick={collectYearlyLightSensorData}>\r\n                            Collect Yearly Data\r\n                        </Menu.Item>\r\n                    </SubMenu>\r\n                </StyledMenu>\r\n            );\r\n        case ObjectType.Cuboid:\r\n            return (\r\n                <StyledMenu>\r\n                    <Menu.Item key={'cuboid-copy'}>\r\n                        Copy\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'cuboid-cut'}>\r\n                        Cut\r\n                    </Menu.Item>\r\n                </StyledMenu>\r\n            );\r\n        default:\r\n            return (\r\n                <StyledMenu>\r\n                    <Menu.Item key={'ground-grid'}>\r\n                        <Checkbox checked={grid} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.grid = e.target.checked;\r\n                            });\r\n                        }}>\r\n                            Grid\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'ground-settings'}>\r\n                        <Checkbox checked={showGroundPanel} onChange={(e) => {\r\n                            setCommonStore(state => {\r\n                                state.showGroundPanel = e.target.checked;\r\n                            });\r\n                        }}>\r\n                            Ground Settings\r\n                        </Checkbox>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={'ground-paste'}>\r\n                        Paste\r\n                    </Menu.Item>\r\n                </StyledMenu>\r\n            );\r\n    }\r\n\r\n};\r\n\r\nexport default ContextMenu;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useEffect, useMemo, useState} from 'react';\r\nimport {\r\n    Bar,\r\n    BarChart,\r\n    CartesianGrid,\r\n    Label,\r\n    Legend,\r\n    ReferenceLine,\r\n    ResponsiveContainer,\r\n    Tooltip,\r\n    XAxis,\r\n    YAxis,\r\n} from 'recharts';\r\nimport {PRESET_COLORS} from \"../constants\";\r\nimport {GraphDataType, DatumEntry} from \"../types\";\r\n\r\nexport interface BarGraphProps {\r\n    type: GraphDataType;\r\n    dataSource: DatumEntry[];\r\n    height: number;\r\n    labelX?: string,\r\n    labelY?: string,\r\n    unitX?: string;\r\n    unitY?: string;\r\n    yMin?: string | number;\r\n    yMax?: string | number;\r\n    fractionDigits?: number;\r\n    referenceX?: number | string;\r\n    color?: string;\r\n\r\n    [key: string]: any;\r\n}\r\n\r\nconst BarGraph = ({\r\n                      type,\r\n                      dataSource,\r\n                      height,\r\n                      labelX,\r\n                      labelY,\r\n                      unitX,\r\n                      unitY,\r\n                      yMin = 'auto',\r\n                      yMax = 'auto',\r\n                      fractionDigits = 2,\r\n                      referenceX,\r\n                      color,\r\n                      ...rest\r\n                  }: BarGraphProps) => {\r\n\r\n    const [dataSetCount, setDataSetCount] = useState<number>(0);\r\n    const [horizontalGridLines, setHorizontalGridLines] = useState<boolean>(true);\r\n    const [verticalGridLines, setVerticalGridLines] = useState<boolean>(true);\r\n    const [legendDataKey, setLegendDataKey] = useState<string | null>(null);\r\n\r\n    //init\r\n    useEffect(() => {\r\n        if (!dataSource) {\r\n            return;\r\n        }\r\n        const len = Array.isArray(dataSource) ? Object.keys(dataSource[0]).length - 1 : Object.keys(dataSource).length - 1;\r\n        if (dataSetCount !== len) {\r\n            setDataSetCount(len);\r\n        }\r\n    }, [dataSource]);\r\n\r\n    const getBars = useMemo(() => {\r\n        const bars = [];\r\n        for (let i = 0; i < dataSetCount; i++) {\r\n            let name = '';\r\n            switch (type) {\r\n                case GraphDataType.MonthlyTemperatures:\r\n                    name = i === 0 ? `Low` : 'High';\r\n                    break;\r\n                case GraphDataType.SunshineHours:\r\n                    name = 'Sunshine';\r\n                    break;\r\n                case GraphDataType.HourlyTemperatures:\r\n                    name = 'Temperature';\r\n                    break;\r\n                case GraphDataType.DaylightData:\r\n                    name = 'Daylight';\r\n                    break;\r\n                case GraphDataType.ClearnessData:\r\n                    name = 'Clearness';\r\n                    break;\r\n                case GraphDataType.DailyRadiationSensorData:\r\n                case GraphDataType.YearlyRadiationSensorData:\r\n                    name = 'Radiation';\r\n                    break;\r\n            }\r\n            const opacity = legendDataKey === null ? 1 : (legendDataKey === name ? 1 : 0.25);\r\n            bars.push(\r\n                <Bar\r\n                    key={i}\r\n                    name={name}\r\n                    dataKey={name}\r\n                    fill={color ? color : PRESET_COLORS[i]}\r\n                    opacity={opacity}\r\n                    isAnimationActive={false}\r\n                />,\r\n            );\r\n        }\r\n        return bars;\r\n    }, [dataSetCount, legendDataKey]);\r\n\r\n    // @ts-ignore\r\n    const onMouseDown = (e) => {\r\n    };\r\n\r\n    // @ts-ignore\r\n    const onMouseEnterLegend = (o) => {\r\n        setLegendDataKey(o.dataKey);\r\n    };\r\n\r\n    // @ts-ignore\r\n    const onMouseLeaveLegend = (o) => {\r\n        setLegendDataKey(null);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {dataSource && (\r\n                // need two div wrappers to disable the responsiveness of ResponsiveContainer\r\n                <div id={'bar-graph-' + labelX + '-' + labelY}\r\n                     style={{width: '100%', height: `${height}%`, position: 'relative'}}>\r\n                    <div\r\n                        style={{\r\n                            userSelect: 'none',\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            position: 'absolute',\r\n                            top: 0,\r\n                            left: 0\r\n                        }}\r\n                    >\r\n                        <ResponsiveContainer width=\"100%\" height={`100%`}>\r\n                            <BarChart\r\n                                data={dataSource}\r\n                                onMouseDown={onMouseDown}\r\n                                margin={{\r\n                                    top: 5,\r\n                                    right: 30,\r\n                                    left: 20,\r\n                                    bottom: 30,\r\n                                }}>\r\n                                <Tooltip formatter={(value: number) => value.toFixed(fractionDigits) + ' ' + unitY}/>\r\n                                <CartesianGrid\r\n                                    vertical={verticalGridLines}\r\n                                    horizontal={horizontalGridLines}\r\n                                    stroke={\"rgba(128, 128, 128, 0.3)\"}\r\n                                />\r\n                                <ReferenceLine\r\n                                    x={referenceX}\r\n                                    stroke=\"orange\"\r\n                                    strokeWidth={2}\r\n                                />\r\n                                <XAxis dataKey={labelX}>\r\n                                    <Label\r\n                                        value={labelX + (unitX ? ' (' + unitX + ')' : '')}\r\n                                        offset={0}\r\n                                        position=\"bottom\"\r\n                                    />\r\n                                </XAxis>\r\n                                <YAxis domain={[yMin, yMax]}>\r\n                                    <Label\r\n                                        dx={-15}\r\n                                        value={labelY + (unitY ? ' (' + unitY + ')' : '')}\r\n                                        offset={0}\r\n                                        angle={-90}\r\n                                        position=\"center\"\r\n                                    />\r\n                                </YAxis>\r\n                                {getBars}\r\n                                {dataSetCount > 1 &&\r\n                                <Legend iconType='plainline'\r\n                                        verticalAlign='top'\r\n                                        height={36}\r\n                                        onMouseLeave={onMouseLeaveLegend}\r\n                                        onMouseEnter={onMouseEnterLegend}/>}\r\n                            </BarChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </div>\r\n            )\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default BarGraph;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useEffect, useMemo, useState} from 'react';\r\nimport {\r\n    CartesianGrid,\r\n    Label,\r\n    Legend,\r\n    Line,\r\n    LineChart,\r\n    ReferenceLine,\r\n    ResponsiveContainer,\r\n    Tooltip,\r\n    XAxis,\r\n    YAxis,\r\n} from 'recharts';\r\nimport {createSymbol, SYMBOLS} from \"./symbols\";\r\nimport {PRESET_COLORS} from \"../constants\";\r\nimport {GraphDataType, DatumEntry} from \"../types\";\r\nimport {CurveType} from \"recharts/types/shape/Curve\";\r\n\r\nexport interface LineGraphProps {\r\n    type: GraphDataType;\r\n    dataSource: DatumEntry[];\r\n    height: number;\r\n    labelX?: string,\r\n    labelY?: string,\r\n    unitX?: string;\r\n    unitY?: string;\r\n    yMin?: string | number;\r\n    yMax?: string | number;\r\n    curveType?: CurveType;\r\n    referenceX?: number | string;\r\n    fractionDigits?: number;\r\n    symbolCount?: number;\r\n\r\n    [key: string]: any;\r\n}\r\n\r\nconst LineGraph = ({\r\n                       type,\r\n                       dataSource,\r\n                       height,\r\n                       labelX,\r\n                       labelY,\r\n                       unitX,\r\n                       unitY,\r\n                       yMin = 'auto',\r\n                       yMax = 'auto',\r\n                       curveType = 'linear',\r\n                       referenceX,\r\n                       fractionDigits = 2,\r\n                       symbolCount = 12,\r\n                       ...rest\r\n                   }: LineGraphProps) => {\r\n\r\n    const [lineCount, setLineCount] = useState<number>(0);\r\n    const [horizontalGridLines, setHorizontalGridLines] = useState<boolean>(true);\r\n    const [verticalGridLines, setVerticalGridLines] = useState<boolean>(true);\r\n    const [legendDataKey, setLegendDataKey] = useState<string | null>(null);\r\n    const [lineWidth, setLineWidth] = useState<number>(2);\r\n    const [symbolSize, setSymbolSize] = useState<number>(1);\r\n\r\n    //init\r\n    useEffect(() => {\r\n        if (!dataSource) {\r\n            return;\r\n        }\r\n        const len = Array.isArray(dataSource) ? Object.keys(dataSource[0]).length - 1 : Object.keys(dataSource).length - 1;\r\n        if (lineCount !== len) {\r\n            setLineCount(len);\r\n        }\r\n    }, [dataSource]);\r\n\r\n    const getLines = useMemo(() => {\r\n        const lines = [];\r\n        let defaultSymbol;\r\n        for (let i = 0; i < lineCount; i++) {\r\n            let name = '';\r\n            switch (type) {\r\n                case GraphDataType.MonthlyTemperatures:\r\n                    name = i === 0 ? `Low` : 'High';\r\n                    break;\r\n                case GraphDataType.SunshineHours:\r\n                    name = 'Sunshine';\r\n                    break;\r\n                case GraphDataType.HourlyTemperatures:\r\n                    name = 'Temperature';\r\n                    break;\r\n                case GraphDataType.DaylightData:\r\n                    name = 'Daylight';\r\n                    break;\r\n                case GraphDataType.ClearnessData:\r\n                    name = 'Clearness';\r\n                    break;\r\n                case GraphDataType.DailyRadiationSensorData:\r\n                case GraphDataType.YearlyRadiationSensorData:\r\n                    name = 'Radiation' + (i + 1);\r\n                    break;\r\n            }\r\n            const opacity = legendDataKey === null ? 1 : (legendDataKey === name ? 1 : 0.25);\r\n            const symbol = createSymbol(\r\n                SYMBOLS[i],\r\n                symbolSize,\r\n                symbolCount,\r\n                opacity\r\n            );\r\n            if (i === 0) defaultSymbol = symbol;\r\n            lines.push(\r\n                <Line\r\n                    key={i}\r\n                    type={curveType}\r\n                    name={name}\r\n                    dataKey={name}\r\n                    stroke={PRESET_COLORS[i]}\r\n                    opacity={opacity}\r\n                    strokeWidth={lineWidth}\r\n                    dot={symbolCount > 0 ? (symbol ? symbol : defaultSymbol) : false}\r\n                    isAnimationActive={false}\r\n                />,\r\n            );\r\n        }\r\n        return lines;\r\n    }, [lineCount, lineWidth, symbolCount, symbolSize, legendDataKey]);\r\n\r\n    // @ts-ignore\r\n    const onMouseDown = (e) => {\r\n    };\r\n\r\n    // @ts-ignore\r\n    const onMouseEnterLegend = (o) => {\r\n        setLegendDataKey(o.dataKey);\r\n    };\r\n\r\n    // @ts-ignore\r\n    const onMouseLeaveLegend = (o) => {\r\n        setLegendDataKey(null);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {dataSource && (\r\n                // need two div wrappers to disable the responsiveness of ResponsiveContainer\r\n                <div id={'line-graph-' + labelX + '-' + labelY}\r\n                     style={{width: '100%', height: `${height}%`, position: 'relative'}}>\r\n                    <div\r\n                        style={{\r\n                            userSelect: 'none',\r\n                            width: '100%',\r\n                            height: '100%',\r\n                            position: 'absolute',\r\n                            top: 0,\r\n                            left: 0\r\n                        }}\r\n                    >\r\n                        <ResponsiveContainer width=\"100%\" height={`100%`}>\r\n                            <LineChart\r\n                                data={dataSource}\r\n                                onMouseDown={onMouseDown}\r\n                                margin={{\r\n                                    top: 5,\r\n                                    right: 30,\r\n                                    left: 20,\r\n                                    bottom: 30,\r\n                                }}>\r\n                                <Tooltip formatter={(value: number) => value.toFixed(fractionDigits) + ' ' + unitY}/>\r\n                                <CartesianGrid\r\n                                    vertical={verticalGridLines}\r\n                                    horizontal={horizontalGridLines}\r\n                                    stroke={\"rgba(128, 128, 128, 0.3)\"}\r\n                                />\r\n                                <ReferenceLine\r\n                                    x={referenceX}\r\n                                    stroke=\"orange\"\r\n                                    strokeWidth={2}\r\n                                />\r\n                                <XAxis dataKey={labelX}>\r\n                                    <Label\r\n                                        value={labelX + (unitX ? ' (' + unitX + ')' : '')}\r\n                                        offset={0}\r\n                                        position=\"bottom\"\r\n                                    />\r\n                                </XAxis>\r\n                                <YAxis domain={[yMin, yMax]}>\r\n                                    <Label\r\n                                        dx={-15}\r\n                                        value={labelY + (unitY ? ' (' + unitY + ')' : '')}\r\n                                        offset={0}\r\n                                        angle={-90}\r\n                                        position=\"center\"\r\n                                    />\r\n                                </YAxis>\r\n                                {getLines}\r\n                                {lineCount > 1 &&\r\n                                <Legend iconType='plainline'\r\n                                        verticalAlign='top'\r\n                                        height={36}\r\n                                        onMouseLeave={onMouseLeaveLegend}\r\n                                        onMouseEnter={onMouseEnterLegend}/>}\r\n                            </LineChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </div>\r\n            )\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default LineGraph;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useMemo, useState} from 'react';\r\nimport BarGraph from \"../components/barGraph\";\r\nimport LineGraph from '../components/lineGraph';\r\nimport {GraphDataType} from \"../types\";\r\nimport styled from \"styled-components\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {MONTHS} from \"../constants\";\r\nimport {Util} from \"../util\";\r\nimport ReactDraggable, {DraggableEventHandler} from \"react-draggable\";\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 80px;\r\n  right: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nconst ColumnWrapper = styled.div`\r\n  background-color: #f8f8f8;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  width: 500px;\r\n  height: 500px;\r\n  padding-bottom: 10px;\r\n  border: 2px solid gainsboro;\r\n  border-radius: 10px 10px 10px 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  border-radius: 10px 10px 0 0;\r\n  width: 100%;\r\n  height: 24px;\r\n  padding: 10px;\r\n  background-color: #e8e8e8;\r\n  color: #888;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: move;\r\n\r\n  svg.icon {\r\n    height: 16px;\r\n    width: 16px;\r\n    padding: 8px;\r\n    fill: #666;\r\n  }\r\n`;\r\n\r\nexport interface WeatherPanelProps {\r\n\r\n    city: string | null;\r\n    graphs: GraphDataType[];\r\n\r\n    [key: string]: any;\r\n\r\n}\r\n\r\nconst WeatherPanel = ({\r\n                          city,\r\n                          graphs,\r\n                          ...rest\r\n                      }: WeatherPanelProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const getWeather = useStore(state => state.getWeather);\r\n    const now = useStore(state => state.date);\r\n    const [curPosition, setCurPosition] = useState({x: 0, y: 0});\r\n\r\n    const responsiveHeight = useMemo(() => {\r\n        return graphs ? Math.floor(100 / graphs.length) : 100;\r\n    }, [graphs]);\r\n\r\n    const getData = useMemo(() => {\r\n        if (!graphs) {\r\n            return;\r\n        }\r\n        const result: any = {};\r\n        if (city) {\r\n            const weather = getWeather(city);\r\n            if (weather) {\r\n                graphs.forEach(g => {\r\n                    result[g] = [];\r\n                    switch (g) {\r\n                        case GraphDataType.MonthlyTemperatures:\r\n                            for (let i = 0; i < 12; i++) {\r\n                                result[g].push(\r\n                                    {\r\n                                        Month: MONTHS[i],\r\n                                        Low: weather.lowestTemperatures[i],\r\n                                        High: weather.highestTemperatures[i]\r\n                                    }\r\n                                );\r\n                            }\r\n                            break;\r\n                        case GraphDataType.SunshineHours:\r\n                            for (let i = 0; i < 12; i++) {\r\n                                result[g].push(\r\n                                    {\r\n                                        Month: MONTHS[i],\r\n                                        Sunshine: weather.sunshineHours[i]\r\n                                    }\r\n                                );\r\n                            }\r\n                            break;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return result;\r\n    }, [graphs, city]);\r\n\r\n    const yNames = ['Temperature', 'Temperature', 'Sunshine'];\r\n    const yUnits = ['C', 'C', 'Hours'];\r\n    const referenceX = MONTHS[Math.floor(Util.daysIntoYear(now) / 365 * 12)];\r\n\r\n    const onDrag: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n        setCurPosition({\r\n            x: ui.x,\r\n            y: ui.y,\r\n        });\r\n    };\r\n\r\n    const onDragStart: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    const onDragEnd: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    return (\r\n        <ReactDraggable\r\n            handle={'.handle'}\r\n            bounds={'parent'}\r\n            axis='both'\r\n            position={curPosition}\r\n            onDrag={onDrag}\r\n            onStart={onDragStart}\r\n            onStop={onDragEnd}\r\n        >\r\n            <Container>\r\n                <ColumnWrapper>\r\n                    <Header className='handle'>\r\n                        <span>Weather: {city}</span>\r\n                        <span style={{cursor: 'pointer'}} onClick={() => {\r\n                            setCommonStore((state) => {\r\n                                state.showWeatherPanel = false;\r\n                            });\r\n                        }}>Close</span>\r\n                    </Header>\r\n                    <>\r\n                        {graphs.map(g => {\r\n                            if (g === GraphDataType.SunshineHours) {\r\n                                return (\r\n                                    <BarGraph\r\n                                        key={g}\r\n                                        type={g}\r\n                                        dataSource={getData[g]}\r\n                                        height={responsiveHeight}\r\n                                        labelX={'Month'}\r\n                                        labelY={yNames[g]}\r\n                                        unitY={yUnits[g]}\r\n                                        yMin={0}\r\n                                        fractionDigits={0}\r\n                                        referenceX={referenceX}\r\n                                        color={'#FFD700'}\r\n                                        {...rest}\r\n                                    />\r\n                                );\r\n                            }\r\n                            return (\r\n                                <LineGraph\r\n                                    key={g}\r\n                                    type={g}\r\n                                    dataSource={getData[g]}\r\n                                    height={responsiveHeight}\r\n                                    labelX={'Month'}\r\n                                    labelY={yNames[g]}\r\n                                    unitY={yUnits[g]}\r\n                                    fractionDigits={0}\r\n                                    referenceX={referenceX}\r\n                                    {...rest}\r\n                                />\r\n                            );\r\n                        })}\r\n                    </>\r\n                </ColumnWrapper>\r\n            </Container>\r\n        </ReactDraggable>\r\n    );\r\n\r\n};\r\n\r\nexport default WeatherPanel;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useState} from 'react';\r\nimport LineGraph from '../components/lineGraph';\r\nimport styled from \"styled-components\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {GraphDataType} from \"../types\";\r\nimport {MONTHS} from \"../constants\";\r\nimport {Util} from \"../util\";\r\nimport BarGraph from \"../components/barGraph\";\r\nimport ReactDraggable, {DraggableEventHandler} from \"react-draggable\";\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 80px;\r\n  right: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nconst ColumnWrapper = styled.div`\r\n  background-color: #f8f8f8;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  width: 500px;\r\n  height: 650px;\r\n  padding-bottom: 10px;\r\n  border: 2px solid gainsboro;\r\n  border-radius: 10px 10px 10px 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow-y: auto;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  border-radius: 10px 10px 0 0;\r\n  width: 100%;\r\n  height: 24px;\r\n  padding: 10px;\r\n  background-color: #e8e8e8;\r\n  color: #888;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: move;\r\n\r\n  svg.icon {\r\n    height: 16px;\r\n    width: 16px;\r\n    padding: 8px;\r\n    fill: #666;\r\n  }\r\n`;\r\n\r\nexport interface YearlyLightSensorPanelProps {\r\n\r\n    city: string | null;\r\n\r\n    [key: string]: any;\r\n\r\n}\r\n\r\nconst YearlyLightSensorPanel = ({\r\n                                    city,\r\n                                    ...rest\r\n                                }: YearlyLightSensorPanelProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const sensorData = useStore(state => state.yearlyLightSensorData);\r\n    const now = useStore(state => state.date);\r\n    const [curPosition, setCurPosition] = useState({x: 0, y: 0});\r\n\r\n    const responsiveHeight = 100;\r\n    const referenceX = MONTHS[Math.floor(Util.daysIntoYear(now) / 365 * 12)];\r\n\r\n    const onDrag: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n        setCurPosition({\r\n            x: ui.x,\r\n            y: ui.y,\r\n        });\r\n    };\r\n\r\n    const onDragStart: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    const onDragEnd: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    return (\r\n        <ReactDraggable\r\n            handle={'.handle'}\r\n            bounds={'parent'}\r\n            axis='both'\r\n            position={curPosition}\r\n            onDrag={onDrag}\r\n            onStart={onDragStart}\r\n            onStop={onDragEnd}\r\n        >\r\n            <Container>\r\n                <ColumnWrapper>\r\n                    <Header className='handle'>\r\n                        <span>Light Sensor: {city}</span>\r\n                        <span style={{cursor: 'pointer'}} onClick={() => {\r\n                            setCommonStore((state) => {\r\n                                state.showYearlyLightSensorPanel = false;\r\n                            });\r\n                        }}>Close</span>\r\n                    </Header>\r\n                    <LineGraph\r\n                        type={GraphDataType.DaylightData}\r\n                        dataSource={sensorData.map(e => ({Month: e.Month, Daylight: e.Daylight}))}\r\n                        height={responsiveHeight}\r\n                        labelX={'Month'}\r\n                        labelY={'Daylight'}\r\n                        unitY={'Hours'}\r\n                        yMin={0}\r\n                        curveType={'natural'}\r\n                        fractionDigits={1}\r\n                        referenceX={referenceX}\r\n                        {...rest}\r\n                    />\r\n                    <BarGraph\r\n                        type={GraphDataType.ClearnessData}\r\n                        dataSource={sensorData.map(e => ({Month: e.Month, Clearness: e.Clearness}))}\r\n                        height={responsiveHeight}\r\n                        labelX={'Month'}\r\n                        labelY={'Clearness'}\r\n                        unitY={'%'}\r\n                        yMin={0}\r\n                        yMax={100}\r\n                        fractionDigits={1}\r\n                        referenceX={referenceX}\r\n                        color={'#66CDAA'}\r\n                        {...rest}\r\n                    />\r\n                    <LineGraph\r\n                        type={GraphDataType.YearlyRadiationSensorData}\r\n                        dataSource={sensorData.map(({Daylight, Clearness, ...item}) => item)}\r\n                        height={responsiveHeight}\r\n                        labelX={'Month'}\r\n                        labelY={'Radiation'}\r\n                        unitY={'kWh/m/day'}\r\n                        yMin={0}\r\n                        curveType={'natural'}\r\n                        fractionDigits={2}\r\n                        referenceX={referenceX}\r\n                        {...rest}\r\n                    />\r\n                </ColumnWrapper>\r\n            </Container>\r\n        </ReactDraggable>\r\n    );\r\n\r\n};\r\n\r\nexport default YearlyLightSensorPanel;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useState} from 'react';\r\nimport LineGraph from '../components/lineGraph';\r\nimport styled from \"styled-components\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {GraphDataType} from \"../types\";\r\nimport moment from \"moment\";\r\nimport ReactDraggable, {DraggableEventHandler} from 'react-draggable';\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 80px;\r\n  right: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nconst ColumnWrapper = styled.div`\r\n  background-color: #f8f8f8;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  width: 600px;\r\n  height: 300px;\r\n  padding-bottom: 10px;\r\n  border: 2px solid gainsboro;\r\n  border-radius: 10px 10px 10px 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  overflow-y: auto;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  border-radius: 10px 10px 0 0;\r\n  width: 100%;\r\n  height: 24px;\r\n  padding: 10px;\r\n  background-color: #e8e8e8;\r\n  color: #888;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  cursor: move;\r\n\r\n  svg.icon {\r\n    height: 16px;\r\n    width: 16px;\r\n    padding: 8px;\r\n    fill: #666;\r\n  }\r\n`;\r\n\r\nexport interface DailyLightSensorPanelProps {\r\n\r\n    city: string | null;\r\n\r\n    [key: string]: any;\r\n\r\n}\r\n\r\nconst DailyLightSensorPanel = ({\r\n                                   city,\r\n                                   ...rest\r\n                               }: DailyLightSensorPanelProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const sensorData = useStore(state => state.dailyLightSensorData);\r\n    const now = new Date(useStore(state => state.date));\r\n    const [curPosition, setCurPosition] = useState({x: 0, y: 0});\r\n\r\n    const responsiveHeight = 100;\r\n\r\n    const onDrag: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n        setCurPosition({\r\n            x: ui.x,\r\n            y: ui.y,\r\n        });\r\n    };\r\n\r\n    const onDragStart: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    const onDragEnd: DraggableEventHandler = (e, ui) => {\r\n        // TODO\r\n    };\r\n\r\n    return (\r\n        <ReactDraggable\r\n            handle={'.handle'}\r\n            bounds={'parent'}\r\n            axis='both'\r\n            position={curPosition}\r\n            onDrag={onDrag}\r\n            onStart={onDragStart}\r\n            onStop={onDragEnd}\r\n        >\r\n            <Container>\r\n                <ColumnWrapper>\r\n                    <Header className='handle'>\r\n                        <span>Light Sensor: {city} | {moment(now).format('MM/DD')}</span>\r\n                        <span style={{cursor: 'pointer'}} onClick={() => {\r\n                            setCommonStore((state) => {\r\n                                state.showDailyLightSensorPanel = false;\r\n                            });\r\n                        }}>Close</span>\r\n                    </Header>\r\n                    <LineGraph\r\n                        type={GraphDataType.DailyRadiationSensorData}\r\n                        dataSource={sensorData}\r\n                        height={responsiveHeight}\r\n                        labelX={'Hour'}\r\n                        labelY={'Radiation'}\r\n                        unitY={'kWh/m/day'}\r\n                        yMin={0}\r\n                        curveType={'linear'}\r\n                        fractionDigits={2}\r\n                        symbolCount={24}\r\n                        referenceX={now.getHours()}\r\n                        {...rest}\r\n                    />\r\n                </ColumnWrapper>\r\n            </Container>\r\n        </ReactDraggable>\r\n    );\r\n\r\n};\r\n\r\nexport default DailyLightSensorPanel;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React, {useEffect, useMemo} from \"react\";\r\nimport {calculateDiffuseAndReflectedRadiation, calculatePeakRadiation, getSunDirection} from \"./sunTools\";\r\nimport {Object3D, Raycaster, Vector3} from \"three\";\r\nimport {useThree} from \"@react-three/fiber\";\r\nimport {useStore} from \"../stores/common\";\r\nimport {DatumEntry, ObjectType} from \"../types\";\r\nimport {Util} from \"../util\";\r\nimport {AirMass} from \"./analysisConstants\";\r\nimport {MONTHS} from \"../constants\";\r\nimport {SensorModel} from \"../models/sensorModel\";\r\n\r\nexport interface SimulationProps {\r\n\r\n    city: string | null;\r\n    dailyLightSensorDataFlag: boolean;\r\n    yearlyLightSensorDataFlag: boolean;\r\n\r\n}\r\n\r\nconst Simulation = ({\r\n                        city,\r\n                        dailyLightSensorDataFlag,\r\n                        yearlyLightSensorDataFlag,\r\n                    }: SimulationProps) => {\r\n\r\n    const world = useStore(state => state.world);\r\n    const elements = useStore(state => state.elements);\r\n    const getWeather = useStore(state => state.getWeather);\r\n    const now = new Date(useStore(state => state.date));\r\n    const latitude = useStore(state => state.latitude);\r\n    const timesPerHour = useStore(state => state.timesPerHour);\r\n    const setDailyLightSensorData = useStore(state => state.setDailyLightSensorData);\r\n    const setYearlyLightSensorData = useStore(state => state.setYearlyLightSensorData);\r\n    const {scene} = useThree();\r\n    const weather = getWeather(city ?? 'Boston MA, USA');\r\n    const elevation = city ? getWeather(city).elevation : 0;\r\n    const interval = 60 / timesPerHour;\r\n    const ray = useMemo(() => new Raycaster(), []);\r\n\r\n    useEffect(() => {\r\n        if (elements && elements.length > 0) {\r\n            collectAllDailyLightSensorData();\r\n        }\r\n    }, [dailyLightSensorDataFlag]);\r\n\r\n    useEffect(() => {\r\n        if (elements && elements.length > 0) {\r\n            collectAllYearlyLightSensorData();\r\n        }\r\n    }, [yearlyLightSensorDataFlag]);\r\n\r\n    const inShadow = (time: Date, position: Vector3, sunDirection: Vector3) => {\r\n        // convert the position and direction from physics model to the coordinate system of three.js\r\n        ray.set(Util.modelToView(position), Util.modelToView(sunDirection));\r\n        const content = scene.children.filter(c => c.name === 'Content');\r\n        if (content.length > 0) {\r\n            const components = content[0].children;\r\n            const objects: Object3D[] = [];\r\n            for (const c of components) {\r\n                objects.push(...c.children.filter(x => x.castShadow));\r\n            }\r\n            const intersects = ray.intersectObjects(objects);\r\n            return intersects.length > 0;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    const collectAllDailyLightSensorData = () => {\r\n        const map = new Map<string, number[]>();\r\n        let index = 0;\r\n        for (const e of elements) {\r\n            if (e.type === ObjectType.Sensor) {\r\n                map.set('Radiation' + (index + 1), collectDailyLightSensorData(e as SensorModel));\r\n                index++;\r\n            }\r\n        }\r\n        const data = [];\r\n        for (let i = 0; i < 24; i++) {\r\n            const datum: DatumEntry = {};\r\n            datum['Hour'] = i;\r\n            for (let k = 1; k <= index; k++) {\r\n                const key = 'Radiation' + k;\r\n                datum[key] = map.get(key)?.[i];\r\n            }\r\n            data.push(datum);\r\n        }\r\n        setDailyLightSensorData(data);\r\n    }\r\n\r\n    const collectDailyLightSensorData = (sensor: SensorModel) => {\r\n        const position = new Vector3(sensor.cx, sensor.cy, sensor.cz);\r\n        const normal = new Vector3(sensor.normal[0], sensor.normal[1], sensor.normal[2]);\r\n        const result = new Array(24).fill(0);\r\n        const year = now.getFullYear();\r\n        const month = now.getMonth();\r\n        const date = now.getDate();\r\n        const dayOfYear = Util.dayOfYear(now);\r\n        let count = 0;\r\n        for (let i = 0; i < 24; i++) {\r\n            for (let j = 0; j < timesPerHour; j++) {\r\n                const cur = new Date(year, month, date, i, j * interval);\r\n                const sunDirection = getSunDirection(cur, latitude);\r\n                if (sunDirection.z > 0) {\r\n                    // when the sun is out\r\n                    count++;\r\n                    const peakRadiation = calculatePeakRadiation(sunDirection, dayOfYear, elevation, AirMass.SPHERE_MODEL);\r\n                    const dot = normal.dot(sunDirection);\r\n                    if (dot > 0) {\r\n                        if (!inShadow(cur, position, sunDirection)) {\r\n                            // direct radiation\r\n                            result[i] += dot * peakRadiation;\r\n                        }\r\n                    }\r\n                    // indirect radiation\r\n                    result[i] += calculateDiffuseAndReflectedRadiation(world.ground, month, normal, peakRadiation);\r\n                }\r\n            }\r\n        }\r\n        // apply clearness and convert the unit of time step from minute to hour so that we get kWh\r\n        const daylight = count * interval / 60;\r\n        const clearness = weather.sunshineHours[month] / (30 * daylight);\r\n        return result.map(x => x * clearness / timesPerHour);\r\n    };\r\n\r\n    const collectAllYearlyLightSensorData = () => {\r\n        const resultArr = [];\r\n        for (const e of elements) {\r\n            if (e.type === ObjectType.Sensor) {\r\n                resultArr.push(collectYearlyLightSensorData(e as SensorModel));\r\n            }\r\n        }\r\n        const results = [];\r\n        for (let month = 0; month < 12; month++) {\r\n            const r: DatumEntry = {};\r\n            r['Month'] = MONTHS[month];\r\n            for (const [i, a] of resultArr.entries()) {\r\n                r['Daylight'] = a[month].Daylight;\r\n                r['Clearness'] = a[month].Clearness;\r\n                r['Radiation' + (i + 1)] = a[month].Radiation;\r\n            }\r\n            results.push(r);\r\n        }\r\n        setYearlyLightSensorData(results);\r\n    }\r\n\r\n    const collectYearlyLightSensorData = (sensor: SensorModel) => {\r\n        const data = [];\r\n        const position = new Vector3(sensor.cx, sensor.cy, sensor.cz);\r\n        const normal = new Vector3(sensor.normal[0], sensor.normal[1], sensor.normal[2]);\r\n        const year = now.getFullYear();\r\n        const date = 15;\r\n        for (let month = 0; month < 12; month++) {\r\n            const midMonth = new Date(year, month, date);\r\n            const dayOfYear = Util.dayOfYear(midMonth);\r\n            let total = 0;\r\n            let count = 0;\r\n            for (let hour = 0; hour < 24; hour++) {\r\n                for (let step = 0; step < timesPerHour; step++) {\r\n                    const cur = new Date(year, month, date, hour, step * interval);\r\n                    const sunDirection = getSunDirection(cur, latitude);\r\n                    if (sunDirection.z > 0) {\r\n                        // when the sun is out\r\n                        count++;\r\n                        const peakRadiation = calculatePeakRadiation(sunDirection, dayOfYear, elevation, AirMass.SPHERE_MODEL);\r\n                        const dot = normal.dot(sunDirection);\r\n                        if (dot > 0) {\r\n                            if (!inShadow(cur, position, sunDirection)) {\r\n                                // direct radiation\r\n                                total += dot * peakRadiation;\r\n                            }\r\n                        }\r\n                        // indirect radiation\r\n                        total += calculateDiffuseAndReflectedRadiation(world.ground, month, normal, peakRadiation);\r\n                    }\r\n                }\r\n            }\r\n            const daylight = count * interval / 60;\r\n            const clearness = weather.sunshineHours[midMonth.getMonth()] / (30 * daylight);\r\n            total *= clearness; // apply clearness\r\n            total /= timesPerHour; // convert the unit of timeStep from minute to hour so that we get kWh\r\n            data.push({\r\n                Month: MONTHS[month],\r\n                Daylight: daylight,\r\n                Clearness: clearness * 100,\r\n                Radiation: total\r\n            } as DatumEntry);\r\n        }\r\n        return data;\r\n    };\r\n\r\n    return <></>;\r\n\r\n};\r\n\r\nexport default Simulation;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport {useStore} from \"./stores/common\";\r\nimport {Button, Space, Switch} from 'antd';\r\nimport 'antd/dist/antd.css';\r\nimport styled from \"styled-components\";\r\nimport {OrbitControls} from \"three/examples/jsm/controls/OrbitControls\";\r\n\r\nconst Container = styled.div`\r\n  position: fixed;\r\n  top: 4px;\r\n  left: 50px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 16px;\r\n  z-index: 9;\r\n`;\r\n\r\nexport interface MainToolBarProps {\r\n    orbitControls?: OrbitControls;\r\n}\r\n\r\nconst MainToolBar = ({orbitControls}: MainToolBarProps) => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const autoRotate = useStore(state => state.autoRotate);\r\n    const heliodon = useStore(state => state.showHeliodonPanel);\r\n\r\n    return (\r\n        <Container>\r\n            <Space direction='horizontal'>\r\n                <div>\r\n                    <span style={{paddingRight: '10px'}}>Spin</span>\r\n                    <Switch title={'Spin view'} checked={autoRotate} onChange={(checked) => {\r\n                        setCommonStore((state) => {\r\n                            state.autoRotate = checked;\r\n                        });\r\n                    }}/>\r\n                </div>\r\n                <div>\r\n                    <span style={{paddingRight: '10px', paddingLeft: '10px'}}>Heliodon</span>\r\n                    <Switch title={'Show heliodon'} checked={heliodon} onChange={(checked) => {\r\n                        setCommonStore((state) => {\r\n                            state.showHeliodonPanel = checked;\r\n                        });\r\n                    }}/>\r\n                </div>\r\n                <div>\r\n                    <Button type=\"primary\" title={'Reset view'} onClick={() => {\r\n                        if (orbitControls) {\r\n                            orbitControls.reset();\r\n                        }\r\n                    }}> Reset </Button>\r\n                </div>\r\n            </Space>\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default MainToolBar;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from \"react\";\r\n\r\nexport interface TeamProps {\r\n    top: number;\r\n    height?: number;\r\n    color?: string;\r\n}\r\n\r\nconst Team = ({top, height, color}: TeamProps) => {\r\n    const linePos = top + 56 + 'px';\r\n    const top110 = top + 110 + 'px';\r\n    const top250 = top + 220 + 'px';\r\n    return <div>\r\n        <div style={{\r\n            position: 'absolute',\r\n            borderRadius: '20px',\r\n            border: 'thin',\r\n            textAlign: 'center',\r\n            left: '15%',\r\n            right: '15%',\r\n            top: top + 'px',\r\n            height: (height ?? 300) + 'px'\r\n        }}>\r\n            <h2 style={{marginTop: '20px', color: color}}>This product is brought to you by</h2>\r\n            <p style={{fontSize: '12px', color: color}}>\r\n                <a target=\"_blank\"\r\n                   rel=\"noopener noreferrer\"\r\n                   href=\"https://intofuture.org/aladdin-terms.html\"\r\n                   style={{color: color}}>\r\n                    Terms of Service\r\n                </a>\r\n                &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;\r\n                <a target=\"_blank\"\r\n                   rel=\"noopener noreferrer\"\r\n                   href=\"https://intofuture.org/aladdin-privacy.html\"\r\n                   style={{color: color}}>\r\n                    Privacy Policy\r\n                </a>\r\n            </p>\r\n        </div>\r\n        <div>\r\n            <hr style={{position: 'absolute', left: '10%', width: '80%', marginTop: linePos, color: color}}/>\r\n            <table style={{\r\n                position: 'absolute',\r\n                border: 'none',\r\n                top: top110,\r\n                left: '10%',\r\n                width: '80%',\r\n                fontSize: 'small',\r\n                color: color\r\n            }}>\r\n                <tbody>\r\n                <tr style={{\r\n                    verticalAlign: 'top'\r\n                }}>\r\n                    <td>\r\n                        <h3 style={{color: color}}>Software</h3>\r\n                        Charles Xie<br/>\r\n                    </td>\r\n                    <td>\r\n                        <h3 style={{color: color}}>Content</h3>\r\n                        Rundong Jiang<br/>\r\n                        Charles Xie<br/>\r\n                    </td>\r\n                    <td>\r\n                        <h3 style={{color: color}}>Research</h3>\r\n                        Shannon Sung<br/>\r\n                        Charles Xie<br/>\r\n                    </td>\r\n                    <td>\r\n                        <h3 style={{color: color}}>Support</h3>\r\n                        Rundong Jiang<br/>\r\n                    </td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div style={{\r\n            position: 'absolute',\r\n            left: '10%',\r\n            marginRight: '10%',\r\n            top: top250,\r\n            fontSize: 'small',\r\n            textAlign: 'justify',\r\n            color: color\r\n        }}>The National Science Foundation (NSF) of the United States generously provided funding for the research\r\n            and development of this product through grant numbers 1918847, 2105695, and 2131097. Any opinions,\r\n            findings, and conclusions or recommendations expressed in this product, however, are those of the authors\r\n            and do not necessarily reflect the views of NSF.\r\n        </div>\r\n    </div>\r\n};\r\n\r\nexport default Team;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n */\r\n\r\nimport React from 'react';\r\nimport styled from 'styled-components';\r\nimport Team from \"./team\";\r\n\r\nconst Container = styled.div`\r\n  position: absolute;\r\n  top: 80px;\r\n  left: 10px;\r\n  display: flex;\r\n  width: 600px;\r\n  height: 400px;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  z-index: 9;\r\n  border-radius: 10px;\r\n  background: dimgray;\r\n  box-shadow: 3px 3px 3px 3px black;\r\n`;\r\n\r\nexport interface AboutProps {\r\n    openAboutUs: (on: boolean) => void;\r\n}\r\n\r\nconst About = ({openAboutUs}: AboutProps) => {\r\n\r\n    return (\r\n        <Container>\r\n            <Team top={10} color={'antiquewhite'}/>\r\n            <div style={{\r\n                position: 'absolute',\r\n                fontSize: 'medium',\r\n                color: 'antiquewhite',\r\n                cursor: 'pointer',\r\n                bottom: '10px'\r\n            }} onClick={() => {\r\n                openAboutUs(false);\r\n            }}>\r\n                Close\r\n            </div>\r\n        </Container>\r\n    );\r\n\r\n};\r\n\r\nexport default About;\r\n","/*\r\n * @Copyright 2021. Institute for Future Intelligence, Inc.\r\n *\r\n * @author Charles Xie\r\n */\r\n\r\nimport React, {Suspense, useEffect, useMemo, useRef, useState} from 'react';\r\nimport './app.css';\r\nimport {Canvas} from '@react-three/fiber';\r\nimport OrbitController from \"./orbitController\";\r\nimport Sky from \"./views/sky\";\r\nimport Axes from \"./views/axes\";\r\nimport Compass from \"./views/compass\";\r\nimport ElementsRenderer from \"./elementsRenderer\";\r\nimport Ground from \"./views/ground\";\r\nimport {useStore} from \"./stores/common\";\r\nimport {Euler, Vector3} from \"three\";\r\nimport Heliodon from \"./views/heliodon\";\r\nimport {Util} from \"./util\";\r\nimport {computeDeclinationAngle, computeHourAngle, computeSunLocation} from \"./analysis/sunTools\";\r\nimport aladdinLogo from './assets/aladdin-logo.png';\r\nimport ifiLogo from './assets/ifi-logo.png';\r\nimport MainMenu from \"./mainMenu\";\r\nimport GroundPanel from \"./panels/groundPanel\";\r\nimport HeliodonPanel from \"./panels/heliodonPanel\";\r\nimport {VERSION} from \"./constants\";\r\nimport {visitIFI} from \"./helpers\";\r\nimport AcceptCookie from \"./acceptCookie\";\r\nimport GroundImage from \"./views/groundImage\";\r\nimport {Dropdown} from \"antd\";\r\nimport ContextMenu from \"./contextMenu\";\r\nimport WeatherPanel from \"./panels/weatherPanel\";\r\nimport {GraphDataType} from \"./types\";\r\nimport YearlyLightSensorPanel from \"./panels/yearlyLightSensorPanel\";\r\nimport DailyLightSensorPanel from \"./panels/dailyLightSensorPanel\";\r\nimport Simulation from \"./analysis/simulation\";\r\nimport MainToolBar from \"./mainToolBar\";\r\nimport {OrbitControls} from \"three/examples/jsm/controls/OrbitControls\";\r\nimport About from \"./about\";\r\n\r\nconst App = () => {\r\n\r\n    const setCommonStore = useStore(state => state.set);\r\n    const world = useStore(state => state.world);\r\n    const loadWeatherData = useStore(state => state.loadWeatherData);\r\n    const getClosestCity = useStore(state => state.getClosestCity);\r\n\r\n    const showGroundPanel = useStore(state => state.showGroundPanel);\r\n    const showHeliodonPanel = useStore(state => state.showHeliodonPanel);\r\n    const showWeatherPanel = useStore(state => state.showWeatherPanel);\r\n    const showDailyLightSensorPanel = useStore(state => state.showDailyLightSensorPanel);\r\n    const showYearlyLightSensorPanel = useStore(state => state.showYearlyLightSensorPanel);\r\n    const autoRotate = useStore(state => state.autoRotate);\r\n\r\n    const axes = useStore(state => state.axes);\r\n    const grid = useStore(state => state.grid);\r\n    const enableOrbitController = useStore(state => state.enableOrbitController);\r\n    const groundImage = useStore(state => state.groundImage);\r\n    const groundColor = useStore(state => state.groundColor);\r\n    const theme = useStore(state => state.theme);\r\n    const heliodon = useStore(state => state.heliodon);\r\n    const latitude = useStore(state => state.latitude);\r\n    const longitude = useStore(state => state.longitude);\r\n    const weatherData = useStore(state => state.weatherData);\r\n    const now = new Date(useStore(state => state.date));\r\n\r\n    const [hourAngle, setHourAngle] = useState<number>(0);\r\n    const [declinationAngle, setDeclinationAngle] = useState<number>(0);\r\n    const [sunlightDirection, setSunlightDirection] = useState<Vector3>(new Vector3(0, 2, 2));\r\n    const [animateSun, setAnimateSun] = useState<boolean>(false);\r\n    const [city, setCity] = useState<string | null>('Boston MA, USA');\r\n    const [dailyLightSensorDataFlag, setDailyLightSensorDataFlag] = useState<boolean>(false);\r\n    const [yearlyLightSensorDataFlag, setYearlyLightSensorDataFlag] = useState<boolean>(false);\r\n    const [aboutUs, setAboutUs] = useState(false);\r\n    const orbitControlsRef = useRef<OrbitControls>();\r\n    const radius = 10;\r\n\r\n    useEffect(() => {\r\n        loadWeatherData();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        setSunlightDirection(computeSunLocation(radius, hourAngle, declinationAngle, Util.toRadians(latitude))\r\n            .applyEuler(new Euler(-Math.PI / 2, 0, 0)));\r\n    }, [latitude, hourAngle, declinationAngle]);\r\n\r\n    useEffect(() => {\r\n        setCity(getClosestCity(latitude, longitude));\r\n    }, [latitude, longitude, weatherData]);\r\n\r\n    const nowString = now.toString();\r\n    useMemo(() => {\r\n        setHourAngle(computeHourAngle(now));\r\n        setDeclinationAngle(computeDeclinationAngle(now));\r\n    }, [nowString]);\r\n\r\n    const cameraPosition = new Vector3(0, 0, 5);\r\n    const panCenter = new Vector3();\r\n    if (world) {\r\n        cameraPosition.set(world.cameraPosition.x, world.cameraPosition.y, world.cameraPosition.z);\r\n        panCenter.set(world.panCenter.x, world.panCenter.y, world.panCenter.z);\r\n    }\r\n\r\n    const setGrid = (on: boolean) => {\r\n        setCommonStore(state => {\r\n            state.grid = on;\r\n        });\r\n    };\r\n\r\n    const setGroundImage = (on: boolean) => {\r\n        setCommonStore(state => {\r\n            state.groundImage = on;\r\n        });\r\n    };\r\n\r\n    const setGroundColor = (color: string) => {\r\n        setCommonStore(state => {\r\n            state.groundColor = color;\r\n        });\r\n    };\r\n\r\n    const setHeliodon = (on: boolean) => {\r\n        setCommonStore(state => {\r\n            state.heliodon = on;\r\n        });\r\n    };\r\n\r\n    // animation state should not be persisted\r\n    const setSunAnimation = (on: boolean) => {\r\n        setAnimateSun(on);\r\n    };\r\n\r\n    const changeDate = (date: Date) => {\r\n        const d = new Date(now);\r\n        d.setFullYear(date.getFullYear());\r\n        d.setMonth(date.getMonth());\r\n        d.setDate(date.getDate());\r\n        setCommonStore(state => {\r\n            state.date = d.toString();\r\n        });\r\n    };\r\n\r\n    const changeTime = (date: Date) => {\r\n        const d = new Date(now);\r\n        d.setHours(date.getHours(), date.getMinutes());\r\n        setCommonStore(state => {\r\n            state.date = d.toString();\r\n        });\r\n    };\r\n\r\n    const changeLatitude = (latitude: number) => {\r\n        setCommonStore(state => {\r\n            state.latitude = latitude;\r\n        });\r\n    };\r\n\r\n    const changeLatitudeAndRemoveAddress = (latitude: number) => {\r\n        setCommonStore(state => {\r\n            state.latitude = latitude;\r\n            state.address = '';\r\n        });\r\n    };\r\n\r\n    const changeLongitude = (longitude: number) => {\r\n        setCommonStore(state => {\r\n            state.longitude = longitude;\r\n        });\r\n    };\r\n\r\n    const changeMapZoom = (zoom: number) => {\r\n        setCommonStore(state => {\r\n            state.mapZoom = zoom;\r\n        });\r\n    };\r\n\r\n    const changeMapTilt = (tilt: number) => {\r\n        setCommonStore(state => {\r\n            state.mapTilt = tilt;\r\n        });\r\n    };\r\n\r\n    const changeMapType = (type: string) => {\r\n        setCommonStore(state => {\r\n            state.mapType = type;\r\n        });\r\n    };\r\n\r\n    const sunAboveHorizon = sunlightDirection.y > 0;\r\n\r\n    const collectDailyLightSensorData = () => {\r\n        setCommonStore(state => {\r\n            state.timesPerHour = 20;\r\n        });\r\n        setDailyLightSensorDataFlag(!dailyLightSensorDataFlag);\r\n        setCommonStore(state => {\r\n            state.showDailyLightSensorPanel = true;\r\n        });\r\n    };\r\n\r\n    const collectYearlyLightSensorData = async () => {\r\n        setCommonStore(state => {\r\n            state.timesPerHour = 20;\r\n        });\r\n        setYearlyLightSensorDataFlag(!yearlyLightSensorDataFlag);\r\n        setCommonStore(state => {\r\n            state.showYearlyLightSensorPanel = true;\r\n        });\r\n    };\r\n\r\n    const openAboutUs = (on: boolean) => {\r\n        setAboutUs(on);\r\n    };\r\n\r\n    console.log('x')\r\n\r\n    return (\r\n        <div className=\"App\">\r\n            <div style={{\r\n                backgroundColor: 'lightblue',\r\n                height: '72px',\r\n                paddingTop: '10px',\r\n                fontSize: '30px'\r\n            }}>\r\n                <img alt='Aladdin Logo' src={aladdinLogo} height='50px' style={{verticalAlign: 'middle'}}/>\r\n                <span style={{paddingLeft: '20px', verticalAlign: 'middle'}}>Aladdin</span>\r\n            </div>\r\n            <div style={{\r\n                position: 'absolute',\r\n                bottom: '10px',\r\n                left: '10px',\r\n                zIndex: 999,\r\n                fontSize: '12px',\r\n                color: 'white'\r\n            }}>\r\n                <img alt='IFI Logo'\r\n                     src={ifiLogo}\r\n                     height='40px'\r\n                     style={{verticalAlign: 'bottom', cursor: 'pointer'}}\r\n                     title={'Go to Institute for Future Intelligence'}\r\n                     onClick={visitIFI}/>\r\n                &nbsp;&nbsp; Institute for Future Intelligence, &copy;{new Date().getFullYear()}. Version {VERSION}\r\n            </div>\r\n            <MainMenu\r\n                collectDailyLightSensorData={collectDailyLightSensorData}\r\n                collectYearlyLightSensorData={collectYearlyLightSensorData}\r\n                openAboutUs={openAboutUs}\r\n            />\r\n            <MainToolBar orbitControls={orbitControlsRef.current}/>\r\n            {showGroundPanel &&\r\n            <GroundPanel grid={grid}\r\n                         groundImage={groundImage}\r\n                         groundColor={groundColor}\r\n                         setGrid={setGrid}\r\n                         setGroundImage={setGroundImage}\r\n                         setGroundColor={setGroundColor}\r\n                         changeLatitude={changeLatitude}\r\n                         changeLongitude={changeLongitude}\r\n                         changeMapZoom={changeMapZoom}\r\n                         changeMapTilt={changeMapTilt}\r\n                         changeMapType={changeMapType}\r\n            />}\r\n            {showHeliodonPanel &&\r\n            <HeliodonPanel latitude={latitude}\r\n                           date={now}\r\n                           heliodon={heliodon}\r\n                           animateSun={animateSun}\r\n                           changeDate={changeDate}\r\n                           changeTime={changeTime}\r\n                           changeLatitude={changeLatitudeAndRemoveAddress}\r\n                           setHeliodon={setHeliodon}\r\n                           setSunAnimation={setSunAnimation}\r\n            />}\r\n            {showYearlyLightSensorPanel && <YearlyLightSensorPanel city={city}/>}\r\n            {showDailyLightSensorPanel && <DailyLightSensorPanel city={city}/>}\r\n            {showWeatherPanel &&\r\n            <WeatherPanel city={city}\r\n                          graphs={[GraphDataType.MonthlyTemperatures, GraphDataType.SunshineHours]}\r\n            />}\r\n            {aboutUs && <About openAboutUs={openAboutUs}/>}\r\n            <Dropdown key={'canvas-context-menu'}\r\n                      trigger={['contextMenu']}\r\n                      overlay={\r\n                          <ContextMenu\r\n                              city={city}\r\n                              collectDailyLightSensorData={collectDailyLightSensorData}\r\n                              collectYearlyLightSensorData={collectYearlyLightSensorData}\r\n                          />\r\n                      }>\r\n                <div>\r\n                    <Canvas shadows={true}\r\n                            camera={{\r\n                                position: cameraPosition,\r\n                                fov: 90\r\n                            }}\r\n                            style={{height: 'calc(100vh - 70px)', backgroundColor: 'black'}}>\r\n                        <OrbitController\r\n                            enabled={enableOrbitController}\r\n                            autoRotate={autoRotate}\r\n                            panCenter={panCenter}\r\n                            orbitControlsRef={orbitControlsRef}\r\n                        />\r\n                        <Suspense fallback={null}>\r\n                            <ElementsRenderer/>\r\n                            <ambientLight intensity={0.25} name={'Ambient Light'}/>\r\n                            <directionalLight\r\n                                name={'Directional Light'}\r\n                                color='white'\r\n                                position={[sunlightDirection.x, sunlightDirection.y, sunlightDirection.z]}\r\n                                intensity={sunAboveHorizon ? 0.5 : 0}\r\n                                castShadow\r\n                                shadow-mapSize-height={512}\r\n                                shadow-mapSize-width={512}\r\n                            />\r\n                            {(grid || !enableOrbitController) &&\r\n                            <gridHelper name={'Grid'} args={[500, 100, 'gray', 'gray']}/>\r\n                            }\r\n                            <Compass/>\r\n                            {/*<Obj/>*/}\r\n                            <Simulation city={city}\r\n                                        dailyLightSensorDataFlag={dailyLightSensorDataFlag}\r\n                                        yearlyLightSensorDataFlag={yearlyLightSensorDataFlag}/>\r\n                            {axes && <Axes/>}\r\n                            <Ground/>\r\n                            {groundImage && <GroundImage/>}\r\n                            <Sky theme={theme} night={!sunAboveHorizon}/>\r\n                            {heliodon &&\r\n                            <Heliodon\r\n                                hourAngle={hourAngle}\r\n                                declinationAngle={declinationAngle}\r\n                                radius={radius}\r\n                                date={now}\r\n                                latitude={Util.toRadians(latitude)}\r\n                            />}\r\n                        </Suspense>\r\n                    </Canvas>\r\n                </div>\r\n            </Dropdown>\r\n            <AcceptCookie/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","/*\n * @Copyright 2021. Institute for Future Intelligence, Inc.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App/>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}